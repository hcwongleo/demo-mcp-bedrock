"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BedrockMcpStack = void 0;
const cdk = require("aws-cdk-lib");
const ec2 = require("aws-cdk-lib/aws-ec2");
const iam = require("aws-cdk-lib/aws-iam");
const elbv2 = require("aws-cdk-lib/aws-elasticloadbalancingv2");
const autoscaling = require("aws-cdk-lib/aws-autoscaling");
class BedrockMcpStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const prefix = props?.namePrefix || 'MCP';
        const allowedCidr = '4.0.0.0/23';
        // Create VPC
        const vpc = new ec2.Vpc(this, `${prefix}-VPC`, {
            maxAzs: 2,
            natGateways: 1,
            subnetConfiguration: [
                {
                    name: 'Public',
                    subnetType: ec2.SubnetType.PUBLIC,
                    cidrMask: 24,
                },
                {
                    name: 'Private',
                    subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,
                    cidrMask: 24,
                }
            ]
        });
        // Create Security Group for ALB
        const albSg = new ec2.SecurityGroup(this, `${prefix}-ALB-SG`, {
            vpc,
            allowAllOutbound: true,
            description: 'Security group for Application Load Balancer',
            disableInlineRules: true
        });
        albSg.addIngressRule(ec2.Peer.ipv4(allowedCidr), ec2.Port.tcp(8502), `Streamlit UI access from ${allowedCidr}`);
        // Create Security Group for EC2
        const ec2Sg = new ec2.SecurityGroup(this, `${prefix}-EC2-SG`, {
            vpc,
            allowAllOutbound: true,
            description: 'Security group for EC2 instances'
        });
        ec2Sg.addIngressRule(ec2.Peer.securityGroupId(albSg.securityGroupId), ec2.Port.tcp(8502), 'Streamlit UI from ALB');
        // Create IAM Role
        const role = new iam.Role(this, 'EC2-Role', {
            assumedBy: new iam.ServicePrincipal('ec2.amazonaws.com'),
            managedPolicies: [
                iam.ManagedPolicy.fromAwsManagedPolicyName('AmazonSSMManagedInstanceCore')
            ]
        });
        // Add Bedrock permissions
        role.addToPolicy(new iam.PolicyStatement({
            effect: iam.Effect.ALLOW,
            actions: [
                'bedrock:InvokeModel*',
                'bedrock:ListFoundationModels'
            ],
            resources: ['*']
        }));
        // Create Application Load Balancer
        const alb = new elbv2.ApplicationLoadBalancer(this, `${prefix}-ALB`, {
            vpc,
            internetFacing: true,
            securityGroup: albSg
        });
        const streamlitListener = alb.addListener('Streamlit', {
            port: 8502,
            protocol: elbv2.ApplicationProtocol.HTTP,
            open: false
        });
        // Create User Data that downloads local code from S3
        const userData = ec2.UserData.forLinux();
        userData.addCommands('#!/bin/bash', 'set -e', 
        // Logging function
        'log() { echo "$(date): $1" | tee -a /var/log/mcp-deployment.log; }', 'log "Starting MCP deployment with local code"', 
        // Set environment variables
        'export HOME=/root', 'export PATH="/usr/local/bin:$PATH"', 'export DEBIAN_FRONTEND=noninteractive', 
        // Update system and install dependencies
        'log "Updating system packages"', 'apt-get update -y', 'apt-get install -y software-properties-common curl wget git build-essential unzip', 
        // Install AWS CLI first (this was the missing piece!)
        'log "Installing AWS CLI"', 'curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"', 'unzip awscliv2.zip', './aws/install', 'rm -rf aws awscliv2.zip', 
        // Install Python 3.12
        'log "Installing Python 3.12"', 'add-apt-repository -y ppa:deadsnakes/ppa', 'apt-get update -y', 'apt-get install -y python3.12 python3.12-venv python3.12-dev python3-pip', 
        // Install Node.js
        'log "Installing Node.js"', 'curl -fsSL https://deb.nodesource.com/setup_22.x | bash -', 'apt-get install -y nodejs', 
        // Install system dependencies
        'log "Installing system dependencies"', 'apt-get install -y portaudio19-dev libasound2-dev libportaudio2 libportaudiocpp0', 
        // Setup ubuntu user environment
        'log "Setting up ubuntu user environment"', 'su - ubuntu -c "curl -LsSf https://astral.sh/uv/install.sh | sh"', 'echo \'export PATH="/home/ubuntu/.local/bin:$PATH"\' >> /home/ubuntu/.bashrc', 
        // Create project directory
        'log "Creating project directory"', 'mkdir -p /home/ubuntu/demo_mcp_on_amazon_bedrock', 'chown ubuntu:ubuntu /home/ubuntu/demo_mcp_on_amazon_bedrock', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock', 
        // Use git clone approach (more reliable than S3)
        'log "Cloning application code from GitHub"', 'su - ubuntu -c "cd /home/ubuntu && git clone https://github.com/aws-samples/demo_mcp_on_amazon_bedrock.git"', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock', 
        // Override config with Nova Pro only
        'log "Configuring Nova Pro only model"', 'cat > conf/config.json << EOL', '{', '\t"models": [', '\t\t{', '\t\t\t"model_id": "us.amazon.nova-pro-v1:0",', '\t\t\t"model_name": "Amazon Nova Pro v1"', '\t\t}', '\t],', '\t"mcpServers": {', '\t}', '}', 'EOL', 
        // Set proper ownership
        'chown -R ubuntu:ubuntu /home/ubuntu/demo_mcp_on_amazon_bedrock', 'chmod 755 /home/ubuntu/demo_mcp_on_amazon_bedrock', 
        // Create necessary directories
        'log "Creating necessary directories"', 'mkdir -p logs tmp', 'chown -R ubuntu:ubuntu logs tmp', 
        // Remove Nova Sonic components if they exist
        'log "Removing Nova Sonic components"', 'rm -f src/nova_sonic_manager.py src/websocket_manager.py || true', 
        // Setup Python environment
        'log "Setting up Python environment"', 'su - ubuntu -c "', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock && \\', 'export PATH=\"/home/ubuntu/.local/bin:$PATH\" && \\', 'python3.12 -m venv .venv && \\', 'source .venv/bin/activate && \\', 'pip install --upgrade pip && \\', 'pip install uv && \\', 'uv sync --no-dev || pip install boto3 botocore fastapi uvicorn mcp openai aiohttp python-dotenv requests pandas pytz rx streamlit streamlit-cookies-controller streamlit-local-storage tzdata uvicorn websockets', '"', 
        // Configure environment (using instance role only)
        'log "Configuring environment"', 'cat > .env << EOL', 'AWS_REGION=' + cdk.Stack.of(this).region, 'LOG_DIR=./logs', 'CHATBOT_SERVICE_PORT=8502', 'MCP_SERVICE_HOST=127.0.0.1', 'MCP_SERVICE_PORT=7002', 'MCP_BASE_URL=http://127.0.0.1:7002', `API_KEY=${cdk.Names.uniqueId(this)}`, 'EOL', 'chown ubuntu:ubuntu .env', 'chmod 600 .env', 
        // Create startup script
        'log "Creating startup script"', 'cat > start_services_local.sh << EOL', '#!/bin/bash', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock', 'source .venv/bin/activate', 'export $(grep -v "^#" .env | xargs)', 'export PYTHONPATH=./src:$PYTHONPATH', '', '# Create log directories', 'mkdir -p ${LOG_DIR}', '', '# Kill any existing processes', 'pkill -f "python.*main.py" || true', 'pkill -f "streamlit" || true', 'sleep 3', '', '# Start MCP service', 'echo "$(date): Starting MCP service" >> ${LOG_DIR}/startup.log', 'nohup python src/main.py \\', '    --mcp-conf conf/config.json \\', '    --user-conf conf/user_mcp_config.json \\', '    --host ${MCP_SERVICE_HOST} \\', '    --port ${MCP_SERVICE_PORT} \\', '    > ${LOG_DIR}/mcp.log 2>&1 &', 'MCP_PID=$!', 'echo $MCP_PID > ${LOG_DIR}/mcp.pid', '', '# Wait for MCP service to start', 'sleep 15', '', '# Check if MCP service is running', 'if ! kill -0 $MCP_PID 2>/dev/null; then', '    echo "$(date): MCP service failed to start" >> ${LOG_DIR}/startup.log', '    exit 1', 'fi', '', '# Start Streamlit service', 'echo "$(date): Starting Streamlit service" >> ${LOG_DIR}/startup.log', 'nohup streamlit run chatbot.py \\', '    --server.port ${CHATBOT_SERVICE_PORT} \\', '    --server.address 0.0.0.0 \\', '    --server.headless true \\', '    > ${LOG_DIR}/streamlit.log 2>&1 &', 'STREAMLIT_PID=$!', 'echo $STREAMLIT_PID > ${LOG_DIR}/streamlit.pid', '', 'echo "$(date): Services started - MCP: $MCP_PID, Streamlit: $STREAMLIT_PID" >> ${LOG_DIR}/startup.log', 'echo "Services started successfully!"', 'EOL', 'chmod +x start_services_local.sh', 'chown ubuntu:ubuntu start_services_local.sh', 
        // Create systemd service
        'log "Creating systemd service"', 'cat > /etc/systemd/system/mcp-services.service << EOL', '[Unit]', 'Description=MCP Services (Local Code)', 'After=network.target', 'Wants=network-online.target', '', '[Service]', 'Type=forking', 'User=ubuntu', 'Group=ubuntu', 'Environment="HOME=/home/ubuntu"', 'Environment="PATH=/home/ubuntu/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"', 'WorkingDirectory=/home/ubuntu/demo_mcp_on_amazon_bedrock', 'ExecStart=/home/ubuntu/demo_mcp_on_amazon_bedrock/start_services_local.sh', 'Restart=always', 'RestartSec=30', 'StandardOutput=journal', 'StandardError=journal', '', '[Install]', 'WantedBy=multi-user.target', 'EOL', 
        // Enable and start service
        'log "Enabling and starting services"', 'systemctl daemon-reload', 'systemctl enable mcp-services', 'sleep 10', 'systemctl start mcp-services', 'sleep 15', 'systemctl status mcp-services >> /var/log/mcp-deployment.log 2>&1 || true', 'log "MCP deployment completed with local code"', 
        // Create health check script
        'cat > /home/ubuntu/check_services.sh << EOL', '#!/bin/bash', 'echo "=== Service Status ==="', 'systemctl status mcp-services --no-pager', 'echo "=== Process Status ==="', 'ps aux | grep -E "(python|streamlit)" | grep -v grep', 'echo "=== Port Status ==="', 'ss -tlnp | grep -E "(7002|8502)"', 'echo "=== Configuration ==="', 'cat /home/ubuntu/demo_mcp_on_amazon_bedrock/conf/config.json', 'echo "=== Recent Logs ==="', 'tail -20 /home/ubuntu/demo_mcp_on_amazon_bedrock/logs/*.log 2>/dev/null || echo "No logs found"', 'echo "=== Streamlit Health ==="', 'curl -s http://localhost:8502 > /dev/null && echo "Streamlit responding" || echo "Streamlit not responding"', 'EOL', 'chmod +x /home/ubuntu/check_services.sh', 'chown ubuntu:ubuntu /home/ubuntu/check_services.sh');
        // Create Launch Template
        const launchTemplate = new ec2.LaunchTemplate(this, `${prefix}-LaunchTemplate`, {
            instanceType: ec2.InstanceType.of(ec2.InstanceClass.C5, ec2.InstanceSize.XLARGE),
            machineImage: ec2.MachineImage.fromSsmParameter('/aws/service/canonical/ubuntu/server/22.04/stable/current/amd64/hvm/ebs-gp2/ami-id', { os: ec2.OperatingSystemType.LINUX }),
            userData,
            role,
            securityGroup: ec2Sg,
            blockDevices: [
                {
                    deviceName: '/dev/sda1',
                    volume: {
                        ebsDevice: {
                            volumeSize: 100,
                            volumeType: ec2.EbsDeviceVolumeType.GP3,
                        }
                    }
                }
            ],
        });
        // Create Auto Scaling Group
        const asg = new autoscaling.AutoScalingGroup(this, `${prefix}-ASG`, {
            vpc,
            launchTemplate,
            minCapacity: 1,
            maxCapacity: 1,
            vpcSubnets: {
                subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS
            }
        });
        // Add ASG as target for ALB
        streamlitListener.addTargets('Streamlit-Target', {
            port: 8502,
            protocol: elbv2.ApplicationProtocol.HTTP,
            targets: [asg],
            healthCheck: {
                path: '/',
                unhealthyThresholdCount: 3,
                healthyThresholdCount: 2,
                interval: cdk.Duration.seconds(30),
                timeout: cdk.Duration.seconds(10),
                healthyHttpCodes: '200,302'
            }
        });
        // Stack Outputs
        new cdk.CfnOutput(this, 'StreamlitEndpoint', {
            value: `http://${alb.loadBalancerDnsName}:8502`,
            description: 'Streamlit UI Endpoint'
        });
        new cdk.CfnOutput(this, 'AllowedCIDR', {
            value: allowedCidr,
            description: 'CIDR block allowed to access the application'
        });
        new cdk.CfnOutput(this, 'DeploymentMethod', {
            value: 'Git Clone from GitHub (with AWS CLI pre-installed)',
            description: 'How the application code is deployed'
        });
        new cdk.CfnOutput(this, 'Authentication', {
            value: 'Uses EC2 Instance Role (no API keys needed)',
            description: 'Authentication method'
        });
    }
}
exports.BedrockMcpStack = BedrockMcpStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmVkcm9jay1tY3Atc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvYmVkcm9jay1tY3Atc3RhY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsbUNBQW1DO0FBQ25DLDJDQUEyQztBQUMzQywyQ0FBMkM7QUFDM0MsZ0VBQWdFO0FBQ2hFLDJEQUEyRDtBQVEzRCxNQUFhLGVBQWdCLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFDNUMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUE0QjtRQUNwRSxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixNQUFNLE1BQU0sR0FBRyxLQUFLLEVBQUUsVUFBVSxJQUFJLEtBQUssQ0FBQztRQUMxQyxNQUFNLFdBQVcsR0FBRyxZQUFZLENBQUM7UUFFakMsYUFBYTtRQUNiLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxNQUFNLE1BQU0sRUFBRTtZQUM3QyxNQUFNLEVBQUUsQ0FBQztZQUNULFdBQVcsRUFBRSxDQUFDO1lBQ2QsbUJBQW1CLEVBQUU7Z0JBQ25CO29CQUNFLElBQUksRUFBRSxRQUFRO29CQUNkLFVBQVUsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLE1BQU07b0JBQ2pDLFFBQVEsRUFBRSxFQUFFO2lCQUNiO2dCQUNEO29CQUNFLElBQUksRUFBRSxTQUFTO29CQUNmLFVBQVUsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLG1CQUFtQjtvQkFDOUMsUUFBUSxFQUFFLEVBQUU7aUJBQ2I7YUFDRjtTQUNGLENBQUMsQ0FBQztRQUVILGdDQUFnQztRQUNoQyxNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLEdBQUcsTUFBTSxTQUFTLEVBQUU7WUFDNUQsR0FBRztZQUNILGdCQUFnQixFQUFFLElBQUk7WUFDdEIsV0FBVyxFQUFFLDhD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Z0IsRUFBRTtZQUN4QyxLQUFLLEVBQUUsNkNBQTZDO1lBQ3BELFdBQVcsRUFBRSx1QkFBdUI7U0FDckMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGO0FBdFhELDBDQXNYQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgKiBhcyBlYzIgZnJvbSAnYXdzLWNkay1saWIvYXdzLWVjMic7XG5pbXBvcnQgKiBhcyBpYW0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWlhbSc7XG5pbXBvcnQgKiBhcyBlbGJ2MiBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZWxhc3RpY2xvYWRiYWxhbmNpbmd2Mic7XG5pbXBvcnQgKiBhcyBhdXRvc2NhbGluZyBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYXV0b3NjYWxpbmcnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmVkcm9ja01jcFN0YWNrUHJvcHMgZXh0ZW5kcyBjZGsuU3RhY2tQcm9wcyB7XG4gIG5hbWVQcmVmaXg/OiBzdHJpbmc7XG4gIGFsbG93ZWRDaWRyPzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQmVkcm9ja01jcFN0YWNrIGV4dGVuZHMgY2RrLlN0YWNrIHtcbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM/OiBCZWRyb2NrTWNwU3RhY2tQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xuXG4gICAgY29uc3QgcHJlZml4ID0gcHJvcHM/Lm5hbWVQcmVmaXggfHwgJ01DUCc7XG4gICAgY29uc3QgYWxsb3dlZENpZHIgPSAnNC4wLjAuMC8yMyc7XG5cbiAgICAvLyBDcmVhdGUgVlBDXG4gICAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGModGhpcywgYCR7cHJlZml4fS1WUENgLCB7XG4gICAgICBtYXhBenM6IDIsXG4gICAgICBuYXRHYXRld2F5czogMSxcbiAgICAgIHN1Ym5ldENvbmZpZ3VyYXRpb246IFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdQdWJsaWMnLFxuICAgICAgICAgIHN1Ym5ldFR5cGU6IGVjMi5TdWJuZXRUeXBlLlBVQkxJQyxcbiAgICAgICAgICBjaWRyTWFzazogMjQsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnUHJpdmF0ZScsXG4gICAgICAgICAgc3VibmV0VHlwZTogZWMyLlN1Ym5ldFR5cGUuUFJJVkFURV9XSVRIX0VHUkVTUyxcbiAgICAgICAgICBjaWRyTWFzazogMjQsXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9KTtcblxuICAgIC8vIENyZWF0ZSBTZWN1cml0eSBHcm91cCBmb3IgQUxCXG4gICAgY29uc3QgYWxiU2cgPSBuZXcgZWMyLlNlY3VyaXR5R3JvdXAodGhpcywgYCR7cHJlZml4fS1BTEItU0dgLCB7XG4gICAgICB2cGMsXG4gICAgICBhbGxvd0FsbE91dGJvdW5kOiB0cnVlLFxuICAgICAgZGVzY3JpcHRpb246ICdTZWN1cml0eSBncm91cCBmb3IgQXBwbGljYXRpb24gTG9hZCBCYWxhbmNlcicsXG4gICAgICBkaXNhYmxlSW5saW5lUnVsZXM6IHRydWVcbiAgICB9KTtcblxuICAgIGFsYlNnLmFkZEluZ3Jlc3NSdWxlKFxuICAgICAgZWMyLlBlZXIuaXB2NChhbGxvd2VkQ2lkciksXG4gICAgICBlYzIuUG9ydC50Y3AoODUwMiksXG4gICAgICBgU3RyZWFtbGl0IFVJIGFjY2VzcyBmcm9tICR7YWxsb3dlZENpZHJ9YFxuICAgICk7XG5cbiAgICAvLyBDcmVhdGUgU2VjdXJpdHkgR3JvdXAgZm9yIEVDMlxuICAgIGNvbnN0IGVjMlNnID0gbmV3IGVjMi5TZWN1cml0eUdyb3VwKHRoaXMsIGAke3ByZWZpeH0tRUMyLVNHYCwge1xuICAgICAgdnBjLFxuICAgICAgYWxsb3dBbGxPdXRib3VuZDogdHJ1ZSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnU2VjdXJpdHkgZ3JvdXAgZm9yIEVDMiBpbnN0YW5jZXMnXG4gICAgfSk7XG5cbiAgICBlYzJTZy5hZGRJbmdyZXNzUnVsZShcbiAgICAgIGVjMi5QZWVyLnNlY3VyaXR5R3JvdXBJZChhbGJTZy5zZWN1cml0eUdyb3VwSWQpLFxuICAgICAgZWMyLlBvcnQudGNwKDg1MDIpLFxuICAgICAgJ1N0cmVhbWxpdCBVSSBmcm9tIEFMQidcbiAgICApO1xuXG4gICAgLy8gQ3JlYXRlIElBTSBSb2xlXG4gICAgY29uc3Qgcm9sZSA9IG5ldyBpYW0uUm9sZSh0aGlzLCAnRUMyLVJvbGUnLCB7XG4gICAgICBhc3N1bWVkQnk6IG5ldyBpYW0uU2VydmljZVByaW5jaXBhbCgnZWMyLmFtYXpvbmF3cy5jb20nKSxcbiAgICAgIG1hbmFnZWRQb2xpY2llczogW1xuICAgICAgICBpYW0uTWFuYWdlZFBvbGljeS5mcm9tQXdzTWFuYWdlZFBvbGljeU5hbWUoJ0FtYXpvblNTTU1hbmFnZWRJbnN0YW5jZUNvcmUnKVxuICAgICAgXVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIEJlZHJvY2sgcGVybWlzc2lvbnNcbiAgICByb2xlLmFkZFRvUG9saWN5KG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcbiAgICAgIGVmZmVjdDogaWFtLkVmZmVjdC5BTExPVyxcbiAgICAgIGFjdGlvbnM6IFtcbiAgICAgICAgJ2JlZHJvY2s6SW52b2tlTW9kZWwqJyxcbiAgICAgICAgJ2JlZHJvY2s6TGlzdEZvdW5kYXRpb25Nb2RlbHMnXG4gICAgICBdLFxuICAgICAgcmVzb3VyY2VzOiBbJyonXVxuICAgIH0pKTtcblxuICAgIC8vIENyZWF0ZSBBcHBsaWNhdGlvbiBMb2FkIEJhbGFuY2VyXG4gICAgY29uc3QgYWxiID0gbmV3IGVsYnYyLkFwcGxpY2F0aW9uTG9hZEJhbGFuY2VyKHRoaXMsIGAke3ByZWZpeH0tQUxCYCwge1xuICAgICAgdnBjLFxuICAgICAgaW50ZXJuZXRGYWNpbmc6IHRydWUsXG4gICAgICBzZWN1cml0eUdyb3VwOiBhbGJTZ1xuICAgIH0pO1xuXG4gICAgY29uc3Qgc3RyZWFtbGl0TGlzdGVuZXIgPSBhbGIuYWRkTGlzdGVuZXIoJ1N0cmVhbWxpdCcsIHsgXG4gICAgICBwb3J0OiA4NTAyLFxuICAgICAgcHJvdG9jb2w6IGVsYnYyLkFwcGxpY2F0aW9uUHJvdG9jb2wuSFRUUCxcbiAgICAgIG9wZW46IGZhbHNlXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgVXNlciBEYXRhIHRoYXQgZG93bmxvYWRzIGxvY2FsIGNvZGUgZnJvbSBTM1xuICAgIGNvbnN0IHVzZXJEYXRhID0gZWMyLlVzZXJEYXRhLmZvckxpbnV4KCk7XG4gICAgdXNlckRhdGEuYWRkQ29tbWFuZHMoXG4gICAgICAnIyEvYmluL2Jhc2gnLFxuICAgICAgJ3NldCAtZScsXG4gICAgICBcbiAgICAgIC8vIExvZ2dpbmcgZnVuY3Rpb25cbiAgICAgICdsb2coKSB7IGVjaG8gXCIkKGRhdGUpOiAkMVwiIHwgdGVlIC1hIC92YXIvbG9nL21jcC1kZXBsb3ltZW50LmxvZzsgfScsXG4gICAgICAnbG9nIFwiU3RhcnRpbmcgTUNQIGRlcGxveW1lbnQgd2l0aCBsb2NhbCBjb2RlXCInLFxuICAgICAgXG4gICAgICAvLyBTZXQgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgICAnZXhwb3J0IEhPTUU9L3Jvb3QnLFxuICAgICAgJ2V4cG9ydCBQQVRIPVwiL3Vzci9sb2NhbC9iaW46JFBBVEhcIicsXG4gICAgICAnZXhwb3J0IERFQklBTl9GUk9OVEVORD1ub25pbnRlcmFjdGl2ZScsXG4gICAgICBcbiAgICAgIC8vIFVwZGF0ZSBzeXN0ZW0gYW5kIGluc3RhbGwgZGVwZW5kZW5jaWVzXG4gICAgICAnbG9nIFwiVXBkYXRpbmcgc3lzdGVtIHBhY2thZ2VzXCInLFxuICAgICAgJ2FwdC1nZXQgdXBkYXRlIC15JyxcbiAgICAgICdhcHQtZ2V0IGluc3RhbGwgLXkgc29mdHdhcmUtcHJvcGVydGllcy1jb21tb24gY3VybCB3Z2V0IGdpdCBidWlsZC1lc3NlbnRpYWwgdW56aXAnLFxuICAgICAgXG4gICAgICAvLyBJbnN0YWxsIEFXUyBDTEkgZmlyc3QgKHRoaXMgd2FzIHRoZSBtaXNzaW5nIHBpZWNlISlcbiAgICAgICdsb2cgXCJJbnN0YWxsaW5nIEFXUyBDTElcIicsXG4gICAgICAnY3VybCBcImh0dHBzOi8vYXdzY2xpLmFtYXpvbmF3cy5jb20vYXdzY2xpLWV4ZS1saW51eC14ODZfNjQuemlwXCIgLW8gXCJhd3NjbGl2Mi56aXBcIicsXG4gICAgICAndW56aXAgYXdzY2xpdjIuemlwJyxcbiAgICAgICcuL2F3cy9pbnN0YWxsJyxcbiAgICAgICdybSAtcmYgYXdzIGF3c2NsaXYyLnppcCcsXG4gICAgICBcbiAgICAgIC8vIEluc3RhbGwgUHl0aG9uIDMuMTJcbiAgICAgICdsb2cgXCJJbnN0YWxsaW5nIFB5dGhvbiAzLjEyXCInLFxuICAgICAgJ2FkZC1hcHQtcmVwb3NpdG9yeSAteSBwcGE6ZGVhZHNuYWtlcy9wcGEnLFxuICAgICAgJ2FwdC1nZXQgdXBkYXRlIC15JyxcbiAgICAgICdhcHQtZ2V0IGluc3RhbGwgLXkgcHl0aG9uMy4xMiBweXRob24zLjEyLXZlbnYgcHl0aG9uMy4xMi1kZXYgcHl0aG9uMy1waXAnLFxuICAgICAgXG4gICAgICAvLyBJbnN0YWxsIE5vZGUuanNcbiAgICAgICdsb2cgXCJJbnN0YWxsaW5nIE5vZGUuanNcIicsXG4gICAgICAnY3VybCAtZnNTTCBodHRwczovL2RlYi5ub2Rlc291cmNlLmNvbS9zZXR1cF8yMi54IHwgYmFzaCAtJyxcbiAgICAgICdhcHQtZ2V0IGluc3RhbGwgLXkgbm9kZWpzJyxcbiAgICAgIFxuICAgICAgLy8gSW5zdGFsbCBzeXN0ZW0gZGVwZW5kZW5jaWVzXG4gICAgICAnbG9nIFwiSW5zdGFsbGluZyBzeXN0ZW0gZGVwZW5kZW5jaWVzXCInLFxuICAgICAgJ2FwdC1nZXQgaW5zdGFsbCAteSBwb3J0YXVkaW8xOS1kZXYgbGliYXNvdW5kMi1kZXYgbGlicG9ydGF1ZGlvMiBsaWJwb3J0YXVkaW9jcHAwJyxcbiAgICAgIFxuICAgICAgLy8gU2V0dXAgdWJ1bnR1IHVzZXIgZW52aXJvbm1lbnRcbiAgICAgICdsb2cgXCJTZXR0aW5nIHVwIHVidW50dSB1c2VyIGVudmlyb25tZW50XCInLFxuICAgICAgJ3N1IC0gdWJ1bnR1IC1jIFwiY3VybCAtTHNTZiBodHRwczovL2FzdHJhbC5zaC91di9pbnN0YWxsLnNoIHwgc2hcIicsXG4gICAgICAnZWNobyBcXCdleHBvcnQgUEFUSD1cIi9ob21lL3VidW50dS8ubG9jYWwvYmluOiRQQVRIXCJcXCcgPj4gL2hvbWUvdWJ1bnR1Ly5iYXNocmMnLFxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgcHJvamVjdCBkaXJlY3RvcnlcbiAgICAgICdsb2cgXCJDcmVhdGluZyBwcm9qZWN0IGRpcmVjdG9yeVwiJyxcbiAgICAgICdta2RpciAtcCAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgJ2Nob3duIHVidW50dTp1YnVudHUgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrJyxcbiAgICAgICdjZCAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgXG4gICAgICAvLyBVc2UgZ2l0IGNsb25lIGFwcHJvYWNoIChtb3JlIHJlbGlhYmxlIHRoYW4gUzMpXG4gICAgICAnbG9nIFwiQ2xvbmluZyBhcHBsaWNhdGlvbiBjb2RlIGZyb20gR2l0SHViXCInLFxuICAgICAgJ3N1IC0gdWJ1bnR1IC1jIFwiY2QgL2hvbWUvdWJ1bnR1ICYmIGdpdCBjbG9uZSBodHRwczovL2dpdGh1Yi5jb20vYXdzLXNhbXBsZXMvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2suZ2l0XCInLFxuICAgICAgJ2NkIC9ob21lL3VidW50dS9kZW1vX21jcF9vbl9hbWF6b25fYmVkcm9jaycsXG4gICAgICBcbiAgICAgIC8vIE92ZXJyaWRlIGNvbmZpZyB3aXRoIE5vdmEgUHJvIG9ubHlcbiAgICAgICdsb2cgXCJDb25maWd1cmluZyBOb3ZhIFBybyBvbmx5IG1vZGVsXCInLFxuICAgICAgJ2NhdCA+IGNvbmYvY29uZmlnLmpzb24gPDwgRU9MJyxcbiAgICAgICd7JyxcbiAgICAgICdcXHRcIm1vZGVsc1wiOiBbJyxcbiAgICAgICdcXHRcXHR7JyxcbiAgICAgICdcXHRcXHRcXHRcIm1vZGVsX2lkXCI6IFwidXMuYW1hem9uLm5vdmEtcHJvLXYxOjBcIiwnLFxuICAgICAgJ1xcdFxcdFxcdFwibW9kZWxfbmFtZVwiOiBcIkFtYXpvbiBOb3ZhIFBybyB2MVwiJyxcbiAgICAgICdcXHRcXHR9JyxcbiAgICAgICdcXHRdLCcsXG4gICAgICAnXFx0XCJtY3BTZXJ2ZXJzXCI6IHsnLFxuICAgICAgJ1xcdH0nLFxuICAgICAgJ30nLFxuICAgICAgJ0VPTCcsXG4gICAgICBcbiAgICAgIC8vIFNldCBwcm9wZXIgb3duZXJzaGlwXG4gICAgICAnY2hvd24gLVIgdWJ1bnR1OnVidW50dSAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgJ2NobW9kIDc1NSAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgbmVjZXNzYXJ5IGRpcmVjdG9yaWVzXG4gICAgICAnbG9nIFwiQ3JlYXRpbmcgbmVjZXNzYXJ5IGRpcmVjdG9yaWVzXCInLFxuICAgICAgJ21rZGlyIC1wIGxvZ3MgdG1wJyxcbiAgICAgICdjaG93biAtUiB1YnVudHU6dWJ1bnR1IGxvZ3MgdG1wJyxcbiAgICAgIFxuICAgICAgLy8gUmVtb3ZlIE5vdmEgU29uaWMgY29tcG9uZW50cyBpZiB0aGV5IGV4aXN0XG4gICAgICAnbG9nIFwiUmVtb3ZpbmcgTm92YSBTb25pYyBjb21wb25lbnRzXCInLFxuICAgICAgJ3JtIC1mIHNyYy9ub3ZhX3NvbmljX21hbmFnZXIucHkgc3JjL3dlYnNvY2tldF9tYW5hZ2VyLnB5IHx8IHRydWUnLFxuICAgICAgXG4gICAgICAvLyBTZXR1cCBQeXRob24gZW52aXJvbm1lbnRcbiAgICAgICdsb2cgXCJTZXR0aW5nIHVwIFB5dGhvbiBlbnZpcm9ubWVudFwiJyxcbiAgICAgICdzdSAtIHVidW50dSAtYyBcIicsXG4gICAgICAnY2QgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrICYmIFxcXFwnLFxuICAgICAgJ2V4cG9ydCBQQVRIPVxcXCIvaG9tZS91YnVudHUvLmxvY2FsL2JpbjokUEFUSFxcXCIgJiYgXFxcXCcsXG4gICAgICAncHl0aG9uMy4xMiAtbSB2ZW52IC52ZW52ICYmIFxcXFwnLFxuICAgICAgJ3NvdXJjZSAudmVudi9iaW4vYWN0aXZhdGUgJiYgXFxcXCcsXG4gICAgICAncGlwIGluc3RhbGwgLS11cGdyYWRlIHBpcCAmJiBcXFxcJyxcbiAgICAgICdwaXAgaW5zdGFsbCB1diAmJiBcXFxcJyxcbiAgICAgICd1diBzeW5jIC0tbm8tZGV2IHx8IHBpcCBpbnN0YWxsIGJvdG8zIGJvdG9jb3JlIGZhc3RhcGkgdXZpY29ybiBtY3Agb3BlbmFpIGFpb2h0dHAgcHl0aG9uLWRvdGVudiByZXF1ZXN0cyBwYW5kYXMgcHl0eiByeCBzdHJlYW1saXQgc3RyZWFtbGl0LWNvb2tpZXMtY29udHJvbGxlciBzdHJlYW1saXQtbG9jYWwtc3RvcmFnZSB0emRhdGEgdXZpY29ybiB3ZWJzb2NrZXRzJyxcbiAgICAgICdcIicsXG4gICAgICBcbiAgICAgIC8vIENvbmZpZ3VyZSBlbnZpcm9ubWVudCAodXNpbmcgaW5zdGFuY2Ugcm9sZSBvbmx5KVxuICAgICAgJ2xvZyBcIkNvbmZpZ3VyaW5nIGVudmlyb25tZW50XCInLFxuICAgICAgJ2NhdCA+IC5lbnYgPDwgRU9MJyxcbiAgICAgICdBV1NfUkVHSU9OPScgKyBjZGsuU3RhY2sub2YodGhpcykucmVnaW9uLFxuICAgICAgJ0xPR19ESVI9Li9sb2dzJyxcbiAgICAgICdDSEFUQk9UX1NFUlZJQ0VfUE9SVD04NTAyJyxcbiAgICAgICdNQ1BfU0VSVklDRV9IT1NUPTEyNy4wLjAuMScsXG4gICAgICAnTUNQX1NFUlZJQ0VfUE9SVD03MDAyJyxcbiAgICAgICdNQ1BfQkFTRV9VUkw9aHR0cDovLzEyNy4wLjAuMTo3MDAyJyxcbiAgICAgIGBBUElfS0VZPSR7Y2RrLk5hbWVzLnVuaXF1ZUlkKHRoaXMpfWAsXG4gICAgICAnRU9MJyxcbiAgICAgICdjaG93biB1YnVudHU6dWJ1bnR1IC5lbnYnLFxuICAgICAgJ2NobW9kIDYwMCAuZW52JyxcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHN0YXJ0dXAgc2NyaXB0XG4gICAgICAnbG9nIFwiQ3JlYXRpbmcgc3RhcnR1cCBzY3JpcHRcIicsXG4gICAgICAnY2F0ID4gc3RhcnRfc2VydmljZXNfbG9jYWwuc2ggPDwgRU9MJyxcbiAgICAgICcjIS9iaW4vYmFzaCcsXG4gICAgICAnY2QgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrJyxcbiAgICAgICdzb3VyY2UgLnZlbnYvYmluL2FjdGl2YXRlJyxcbiAgICAgICdleHBvcnQgJChncmVwIC12IFwiXiNcIiAuZW52IHwgeGFyZ3MpJyxcbiAgICAgICdleHBvcnQgUFlUSE9OUEFUSD0uL3NyYzokUFlUSE9OUEFUSCcsXG4gICAgICAnJyxcbiAgICAgICcjIENyZWF0ZSBsb2cgZGlyZWN0b3JpZXMnLFxuICAgICAgJ21rZGlyIC1wICR7TE9HX0RJUn0nLFxuICAgICAgJycsXG4gICAgICAnIyBLaWxsIGFueSBleGlzdGluZyBwcm9jZXNzZXMnLFxuICAgICAgJ3BraWxsIC1mIFwicHl0aG9uLiptYWluLnB5XCIgfHwgdHJ1ZScsXG4gICAgICAncGtpbGwgLWYgXCJzdHJlYW1saXRcIiB8fCB0cnVlJyxcbiAgICAgICdzbGVlcCAzJyxcbiAgICAgICcnLFxuICAgICAgJyMgU3RhcnQgTUNQIHNlcnZpY2UnLFxuICAgICAgJ2VjaG8gXCIkKGRhdGUpOiBTdGFydGluZyBNQ1Agc2VydmljZVwiID4+ICR7TE9HX0RJUn0vc3RhcnR1cC5sb2cnLFxuICAgICAgJ25vaHVwIHB5dGhvbiBzcmMvbWFpbi5weSBcXFxcJyxcbiAgICAgICcgICAgLS1tY3AtY29uZiBjb25mL2NvbmZpZy5qc29uIFxcXFwnLFxuICAgICAgJyAgICAtLXVzZXItY29uZiBjb25mL3VzZXJfbWNwX2NvbmZpZy5qc29uIFxcXFwnLFxuICAgICAgJyAgICAtLWhvc3QgJHtNQ1BfU0VSVklDRV9IT1NUfSBcXFxcJyxcbiAgICAgICcgICAgLS1wb3J0ICR7TUNQX1NFUlZJQ0VfUE9SVH0gXFxcXCcsXG4gICAgICAnICAgID4gJHtMT0dfRElSfS9tY3AubG9nIDI+JjEgJicsXG4gICAgICAnTUNQX1BJRD0kIScsXG4gICAgICAnZWNobyAkTUNQX1BJRCA+ICR7TE9HX0RJUn0vbWNwLnBpZCcsXG4gICAgICAnJyxcbiAgICAgICcjIFdhaXQgZm9yIE1DUCBzZXJ2aWNlIHRvIHN0YXJ0JyxcbiAgICAgICdzbGVlcCAxNScsXG4gICAgICAnJyxcbiAgICAgICcjIENoZWNrIGlmIE1DUCBzZXJ2aWNlIGlzIHJ1bm5pbmcnLFxuICAgICAgJ2lmICEga2lsbCAtMCAkTUNQX1BJRCAyPi9kZXYvbnVsbDsgdGhlbicsXG4gICAgICAnICAgIGVjaG8gXCIkKGRhdGUpOiBNQ1Agc2VydmljZSBmYWlsZWQgdG8gc3RhcnRcIiA+PiAke0xPR19ESVJ9L3N0YXJ0dXAubG9nJyxcbiAgICAgICcgICAgZXhpdCAxJyxcbiAgICAgICdmaScsXG4gICAgICAnJyxcbiAgICAgICcjIFN0YXJ0IFN0cmVhbWxpdCBzZXJ2aWNlJyxcbiAgICAgICdlY2hvIFwiJChkYXRlKTogU3RhcnRpbmcgU3RyZWFtbGl0IHNlcnZpY2VcIiA+PiAke0xPR19ESVJ9L3N0YXJ0dXAubG9nJyxcbiAgICAgICdub2h1cCBzdHJlYW1saXQgcnVuIGNoYXRib3QucHkgXFxcXCcsXG4gICAgICAnICAgIC0tc2VydmVyLnBvcnQgJHtDSEFUQk9UX1NFUlZJQ0VfUE9SVH0gXFxcXCcsXG4gICAgICAnICAgIC0tc2VydmVyLmFkZHJlc3MgMC4wLjAuMCBcXFxcJyxcbiAgICAgICcgICAgLS1zZXJ2ZXIuaGVhZGxlc3MgdHJ1ZSBcXFxcJyxcbiAgICAgICcgICAgPiAke0xPR19ESVJ9L3N0cmVhbWxpdC5sb2cgMj4mMSAmJyxcbiAgICAgICdTVFJFQU1MSVRfUElEPSQhJyxcbiAgICAgICdlY2hvICRTVFJFQU1MSVRfUElEID4gJHtMT0dfRElSfS9zdHJlYW1saXQucGlkJyxcbiAgICAgICcnLFxuICAgICAgJ2VjaG8gXCIkKGRhdGUpOiBTZXJ2aWNlcyBzdGFydGVkIC0gTUNQOiAkTUNQX1BJRCwgU3RyZWFtbGl0OiAkU1RSRUFNTElUX1BJRFwiID4+ICR7TE9HX0RJUn0vc3RhcnR1cC5sb2cnLFxuICAgICAgJ2VjaG8gXCJTZXJ2aWNlcyBzdGFydGVkIHN1Y2Nlc3NmdWxseSFcIicsXG4gICAgICAnRU9MJyxcbiAgICAgIFxuICAgICAgJ2NobW9kICt4IHN0YXJ0X3NlcnZpY2VzX2xvY2FsLnNoJyxcbiAgICAgICdjaG93biB1YnVudHU6dWJ1bnR1IHN0YXJ0X3NlcnZpY2VzX2xvY2FsLnNoJyxcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHN5c3RlbWQgc2VydmljZVxuICAgICAgJ2xvZyBcIkNyZWF0aW5nIHN5c3RlbWQgc2VydmljZVwiJyxcbiAgICAgICdjYXQgPiAvZXRjL3N5c3RlbWQvc3lzdGVtL21jcC1zZXJ2aWNlcy5zZXJ2aWNlIDw8IEVPTCcsXG4gICAgICAnW1VuaXRdJyxcbiAgICAgICdEZXNjcmlwdGlvbj1NQ1AgU2VydmljZXMgKExvY2FsIENvZGUpJyxcbiAgICAgICdBZnRlcj1uZXR3b3JrLnRhcmdldCcsXG4gICAgICAnV2FudHM9bmV0d29yay1vbmxpbmUudGFyZ2V0JyxcbiAgICAgICcnLFxuICAgICAgJ1tTZXJ2aWNlXScsXG4gICAgICAnVHlwZT1mb3JraW5nJyxcbiAgICAgICdVc2VyPXVidW50dScsXG4gICAgICAnR3JvdXA9dWJ1bnR1JyxcbiAgICAgICdFbnZpcm9ubWVudD1cIkhPTUU9L2hvbWUvdWJ1bnR1XCInLFxuICAgICAgJ0Vudmlyb25tZW50PVwiUEFUSD0vaG9tZS91YnVudHUvLmxvY2FsL2JpbjovdXNyL2xvY2FsL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9zYmluOi91c3IvYmluOi9zYmluOi9iaW5cIicsXG4gICAgICAnV29ya2luZ0RpcmVjdG9yeT0vaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgJ0V4ZWNTdGFydD0vaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2svc3RhcnRfc2VydmljZXNfbG9jYWwuc2gnLFxuICAgICAgJ1Jlc3RhcnQ9YWx3YXlzJyxcbiAgICAgICdSZXN0YXJ0U2VjPTMwJyxcbiAgICAgICdTdGFuZGFyZE91dHB1dD1qb3VybmFsJyxcbiAgICAgICdTdGFuZGFyZEVycm9yPWpvdXJuYWwnLFxuICAgICAgJycsXG4gICAgICAnW0luc3RhbGxdJyxcbiAgICAgICdXYW50ZWRCeT1tdWx0aS11c2VyLnRhcmdldCcsXG4gICAgICAnRU9MJyxcbiAgICAgIFxuICAgICAgLy8gRW5hYmxlIGFuZCBzdGFydCBzZXJ2aWNlXG4gICAgICAnbG9nIFwiRW5hYmxpbmcgYW5kIHN0YXJ0aW5nIHNlcnZpY2VzXCInLFxuICAgICAgJ3N5c3RlbWN0bCBkYWVtb24tcmVsb2FkJyxcbiAgICAgICdzeXN0ZW1jdGwgZW5hYmxlIG1jcC1zZXJ2aWNlcycsXG4gICAgICAnc2xlZXAgMTAnLFxuICAgICAgJ3N5c3RlbWN0bCBzdGFydCBtY3Atc2VydmljZXMnLFxuICAgICAgJ3NsZWVwIDE1JyxcbiAgICAgICdzeXN0ZW1jdGwgc3RhdHVzIG1jcC1zZXJ2aWNlcyA+PiAvdmFyL2xvZy9tY3AtZGVwbG95bWVudC5sb2cgMj4mMSB8fCB0cnVlJyxcbiAgICAgICdsb2cgXCJNQ1AgZGVwbG95bWVudCBjb21wbGV0ZWQgd2l0aCBsb2NhbCBjb2RlXCInLFxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgaGVhbHRoIGNoZWNrIHNjcmlwdFxuICAgICAgJ2NhdCA+IC9ob21lL3VidW50dS9jaGVja19zZXJ2aWNlcy5zaCA8PCBFT0wnLFxuICAgICAgJyMhL2Jpbi9iYXNoJyxcbiAgICAgICdlY2hvIFwiPT09IFNlcnZpY2UgU3RhdHVzID09PVwiJyxcbiAgICAgICdzeXN0ZW1jdGwgc3RhdHVzIG1jcC1zZXJ2aWNlcyAtLW5vLXBhZ2VyJyxcbiAgICAgICdlY2hvIFwiPT09IFByb2Nlc3MgU3RhdHVzID09PVwiJyxcbiAgICAgICdwcyBhdXggfCBncmVwIC1FIFwiKHB5dGhvbnxzdHJlYW1saXQpXCIgfCBncmVwIC12IGdyZXAnLFxuICAgICAgJ2VjaG8gXCI9PT0gUG9ydCBTdGF0dXMgPT09XCInLFxuICAgICAgJ3NzIC10bG5wIHwgZ3JlcCAtRSBcIig3MDAyfDg1MDIpXCInLFxuICAgICAgJ2VjaG8gXCI9PT0gQ29uZmlndXJhdGlvbiA9PT1cIicsXG4gICAgICAnY2F0IC9ob21lL3VidW50dS9kZW1vX21jcF9vbl9hbWF6b25fYmVkcm9jay9jb25mL2NvbmZpZy5qc29uJyxcbiAgICAgICdlY2hvIFwiPT09IFJlY2VudCBMb2dzID09PVwiJyxcbiAgICAgICd0YWlsIC0yMCAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2svbG9ncy8qLmxvZyAyPi9kZXYvbnVsbCB8fCBlY2hvIFwiTm8gbG9ncyBmb3VuZFwiJyxcbiAgICAgICdlY2hvIFwiPT09IFN0cmVhbWxpdCBIZWFsdGggPT09XCInLFxuICAgICAgJ2N1cmwgLXMgaHR0cDovL2xvY2FsaG9zdDo4NTAyID4gL2Rldi9udWxsICYmIGVjaG8gXCJTdHJlYW1saXQgcmVzcG9uZGluZ1wiIHx8IGVjaG8gXCJTdHJlYW1saXQgbm90IHJlc3BvbmRpbmdcIicsXG4gICAgICAnRU9MJyxcbiAgICAgICdjaG1vZCAreCAvaG9tZS91YnVudHUvY2hlY2tfc2VydmljZXMuc2gnLFxuICAgICAgJ2Nob3duIHVidW50dTp1YnVudHUgL2hvbWUvdWJ1bnR1L2NoZWNrX3NlcnZpY2VzLnNoJ1xuICAgICk7XG5cbiAgICAvLyBDcmVhdGUgTGF1bmNoIFRlbXBsYXRlXG4gICAgY29uc3QgbGF1bmNoVGVtcGxhdGUgPSBuZXcgZWMyLkxhdW5jaFRlbXBsYXRlKHRoaXMsIGAke3ByZWZpeH0tTGF1bmNoVGVtcGxhdGVgLCB7XG4gICAgICBpbnN0YW5jZVR5cGU6IGVjMi5JbnN0YW5jZVR5cGUub2YoZWMyLkluc3RhbmNlQ2xhc3MuQzUsIGVjMi5JbnN0YW5jZVNpemUuWExBUkdFKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogZWMyLk1hY2hpbmVJbWFnZS5mcm9tU3NtUGFyYW1ldGVyKFxuICAgICAgICAnL2F3cy9zZXJ2aWNlL2Nhbm9uaWNhbC91YnVudHUvc2VydmVyLzIyLjA0L3N0YWJsZS9jdXJyZW50L2FtZDY0L2h2bS9lYnMtZ3AyL2FtaS1pZCcsXG4gICAgICAgIHsgb3M6IGVjMi5PcGVyYXRpbmdTeXN0ZW1UeXBlLkxJTlVYIH1cbiAgICAgICksXG4gICAgICB1c2VyRGF0YSxcbiAgICAgIHJvbGUsXG4gICAgICBzZWN1cml0eUdyb3VwOiBlYzJTZyxcbiAgICAgIGJsb2NrRGV2aWNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgZGV2aWNlTmFtZTogJy9kZXYvc2RhMScsXG4gICAgICAgICAgdm9sdW1lOiB7XG4gICAgICAgICAgICBlYnNEZXZpY2U6IHtcbiAgICAgICAgICAgICAgdm9sdW1lU2l6ZTogMTAwLFxuICAgICAgICAgICAgICB2b2x1bWVUeXBlOiBlYzIuRWJzRGV2aWNlVm9sdW1lVHlwZS5HUDMsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdLFxuICAgIH0pO1xuICAgIFxuICAgIC8vIENyZWF0ZSBBdXRvIFNjYWxpbmcgR3JvdXBcbiAgICBjb25zdCBhc2cgPSBuZXcgYXV0b3NjYWxpbmcuQXV0b1NjYWxpbmdHcm91cCh0aGlzLCBgJHtwcmVmaXh9LUFTR2AsIHtcbiAgICAgIHZwYyxcbiAgICAgIGxhdW5jaFRlbXBsYXRlLFxuICAgICAgbWluQ2FwYWNpdHk6IDEsXG4gICAgICBtYXhDYXBhY2l0eTogMSxcbiAgICAgIHZwY1N1Ym5ldHM6IHtcbiAgICAgICAgc3VibmV0VHlwZTogZWMyLlN1Ym5ldFR5cGUuUFJJVkFURV9XSVRIX0VHUkVTU1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIEFTRyBhcyB0YXJnZXQgZm9yIEFMQlxuICAgIHN0cmVhbWxpdExpc3RlbmVyLmFkZFRhcmdldHMoJ1N0cmVhbWxpdC1UYXJnZXQnLCB7XG4gICAgICBwb3J0OiA4NTAyLFxuICAgICAgcHJvdG9jb2w6IGVsYnYyLkFwcGxpY2F0aW9uUHJvdG9jb2wuSFRUUCxcbiAgICAgIHRhcmdldHM6IFthc2ddLFxuICAgICAgaGVhbHRoQ2hlY2s6IHtcbiAgICAgICAgcGF0aDogJy8nLFxuICAgICAgICB1bmhlYWx0aHlUaHJlc2hvbGRDb3VudDogMyxcbiAgICAgICAgaGVhbHRoeVRocmVzaG9sZENvdW50OiAyLFxuICAgICAgICBpbnRlcnZhbDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMzApLFxuICAgICAgICB0aW1lb3V0OiBjZGsuRHVyYXRpb24uc2Vjb25kcygxMCksXG4gICAgICAgIGhlYWx0aHlIdHRwQ29kZXM6ICcyMDAsMzAyJ1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU3RhY2sgT3V0cHV0c1xuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsICdTdHJlYW1saXRFbmRwb2ludCcsIHtcbiAgICAgIHZhbHVlOiBgaHR0cDovLyR7YWxiLmxvYWRCYWxhbmNlckRuc05hbWV9Ojg1MDJgLFxuICAgICAgZGVzY3JpcHRpb246ICdTdHJlYW1saXQgVUkgRW5kcG9pbnQnXG4gICAgfSk7XG5cbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnQWxsb3dlZENJRFInLCB7XG4gICAgICB2YWx1ZTogYWxsb3dlZENpZHIsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NJRFIgYmxvY2sgYWxsb3dlZCB0byBhY2Nlc3MgdGhlIGFwcGxpY2F0aW9uJ1xuICAgIH0pO1xuXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0RlcGxveW1lbnRNZXRob2QnLCB7XG4gICAgICB2YWx1ZTogJ0dpdCBDbG9uZSBmcm9tIEdpdEh1YiAod2l0aCBBV1MgQ0xJIHByZS1pbnN0YWxsZWQpJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnSG93IHRoZSBhcHBsaWNhdGlvbiBjb2RlIGlzIGRlcGxveWVkJ1xuICAgIH0pO1xuXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0F1dGhlbnRpY2F0aW9uJywge1xuICAgICAgdmFsdWU6ICdVc2VzIEVDMiBJbnN0YW5jZSBSb2xlIChubyBBUEkga2V5cyBuZWVkZWQpJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQXV0aGVudGljYXRpb24gbWV0aG9kJ1xuICAgIH0pO1xuICB9XG59XG4iXX0=