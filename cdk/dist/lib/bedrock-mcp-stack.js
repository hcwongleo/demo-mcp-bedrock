"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BedrockMcpStack = void 0;
const cdk = require("aws-cdk-lib");
const ec2 = require("aws-cdk-lib/aws-ec2");
const iam = require("aws-cdk-lib/aws-iam");
const elbv2 = require("aws-cdk-lib/aws-elasticloadbalancingv2");
const autoscaling = require("aws-cdk-lib/aws-autoscaling");
class BedrockMcpStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const prefix = props?.namePrefix || 'MCP';
        const allowedCidr = '4.0.0.0/23';
        // Create VPC
        const vpc = new ec2.Vpc(this, `${prefix}-VPC`, {
            maxAzs: 2,
            natGateways: 1,
            subnetConfiguration: [
                {
                    name: 'Public',
                    subnetType: ec2.SubnetType.PUBLIC,
                    cidrMask: 24,
                },
                {
                    name: 'Private',
                    subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,
                    cidrMask: 24,
                }
            ]
        });
        // Create Security Group for ALB
        const albSg = new ec2.SecurityGroup(this, `${prefix}-ALB-SG`, {
            vpc,
            allowAllOutbound: true,
            description: 'Security group for Application Load Balancer',
            disableInlineRules: true
        });
        albSg.addIngressRule(ec2.Peer.ipv4(allowedCidr), ec2.Port.tcp(8502), `Streamlit UI access from ${allowedCidr}`);
        // Create Security Group for EC2
        const ec2Sg = new ec2.SecurityGroup(this, `${prefix}-EC2-SG`, {
            vpc,
            allowAllOutbound: true,
            description: 'Security group for EC2 instances'
        });
        ec2Sg.addIngressRule(ec2.Peer.securityGroupId(albSg.securityGroupId), ec2.Port.tcp(8502), 'Streamlit UI from ALB');
        // Create IAM Role
        const role = new iam.Role(this, 'EC2-Role', {
            assumedBy: new iam.ServicePrincipal('ec2.amazonaws.com'),
            managedPolicies: [
                iam.ManagedPolicy.fromAwsManagedPolicyName('AmazonSSMManagedInstanceCore')
            ]
        });
        // Add Bedrock permissions
        role.addToPolicy(new iam.PolicyStatement({
            effect: iam.Effect.ALLOW,
            actions: [
                'bedrock:InvokeModel*',
                'bedrock:ListFoundationModels'
            ],
            resources: ['*']
        }));
        // Create Application Load Balancer
        const alb = new elbv2.ApplicationLoadBalancer(this, `${prefix}-ALB`, {
            vpc,
            internetFacing: true,
            securityGroup: albSg
        });
        const streamlitListener = alb.addListener('Streamlit', {
            port: 8502,
            protocol: elbv2.ApplicationProtocol.HTTP,
            open: false
        });
        // Create User Data that downloads local code from S3
        const userData = ec2.UserData.forLinux();
        userData.addCommands('#!/bin/bash', 'set -e', 
        // Logging function
        'log() { echo "$(date): $1" | tee -a /var/log/mcp-deployment.log; }', 'log "Starting MCP deployment with local code"', 
        // Set environment variables
        'export HOME=/root', 'export PATH="/usr/local/bin:$PATH"', 'export DEBIAN_FRONTEND=noninteractive', 
        // Update system and install dependencies
        'log "Updating system packages"', 'apt-get update -y', 'apt-get install -y software-properties-common curl wget git build-essential unzip', 
        // Install AWS CLI first (this was the missing piece!)
        'log "Installing AWS CLI"', 'curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"', 'unzip awscliv2.zip', './aws/install', 'rm -rf aws awscliv2.zip', 
        // Install Python 3.12
        'log "Installing Python 3.12"', 'add-apt-repository -y ppa:deadsnakes/ppa', 'apt-get update -y', 'apt-get install -y python3.12 python3.12-venv python3.12-dev python3-pip', 
        // Install Node.js
        'log "Installing Node.js"', 'curl -fsSL https://deb.nodesource.com/setup_22.x | bash -', 'apt-get install -y nodejs', 
        // Install system dependencies
        'log "Installing system dependencies"', 'apt-get install -y portaudio19-dev libasound2-dev libportaudio2 libportaudiocpp0', 
        // Setup ubuntu user environment
        'log "Setting up ubuntu user environment"', 'su - ubuntu -c "curl -LsSf https://astral.sh/uv/install.sh | sh"', 'echo \'export PATH="/home/ubuntu/.local/bin:$PATH"\' >> /home/ubuntu/.bashrc', 
        // Create project directory
        'log "Creating project directory"', 'mkdir -p /home/ubuntu/demo_mcp_on_amazon_bedrock', 'chown ubuntu:ubuntu /home/ubuntu/demo_mcp_on_amazon_bedrock', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock', 
        // Use git clone approach (more reliable than S3)
        'log "Cloning application code from GitHub"', 'su - ubuntu -c "cd /home/ubuntu && git clone https://github.com/hcwongleo/demo-mcp-bedrock.git demo_mcp_on_amazon_bedrock"', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock', 
        // Override config with Nova Pro only
        'log "Configuring Nova Pro only model"', 'cat > conf/config.json << EOL', '{', '\t"models": [', '\t\t{', '\t\t\t"model_id": "us.amazon.nova-pro-v1:0",', '\t\t\t"model_name": "Amazon Nova Pro v1"', '\t\t}', '\t],', '\t"mcpServers": {', '\t}', '}', 'EOL', 
        // Set proper ownership
        'chown -R ubuntu:ubuntu /home/ubuntu/demo_mcp_on_amazon_bedrock', 'chmod 755 /home/ubuntu/demo_mcp_on_amazon_bedrock', 
        // Create necessary directories
        'log "Creating necessary directories"', 'mkdir -p logs tmp', 'chown -R ubuntu:ubuntu logs tmp', 
        // Remove Nova Sonic components if they exist
        'log "Removing Nova Sonic components"', 'rm -f src/nova_sonic_manager.py src/websocket_manager.py || true', 
        // Setup Python environment
        'log "Setting up Python environment"', 'su - ubuntu -c "', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock && \\', 'export PATH=\"/home/ubuntu/.local/bin:$PATH\" && \\', 'python3.12 -m venv .venv && \\', 'source .venv/bin/activate && \\', 'pip install --upgrade pip && \\', 'pip install uv && \\', 'uv sync --no-dev || pip install boto3 botocore fastapi uvicorn mcp openai aiohttp python-dotenv requests pandas pytz rx streamlit streamlit-cookies-controller streamlit-local-storage tzdata uvicorn websockets', '"', 
        // Configure environment (using instance role only)
        'log "Configuring environment"', 'cat > .env << EOL', 'AWS_REGION=' + cdk.Stack.of(this).region, 'LOG_DIR=./logs', 'CHATBOT_SERVICE_PORT=8502', 'MCP_SERVICE_HOST=127.0.0.1', 'MCP_SERVICE_PORT=7002', 'MCP_BASE_URL=http://127.0.0.1:7002', `API_KEY=${cdk.Names.uniqueId(this)}`, 'EOL', 'chown ubuntu:ubuntu .env', 'chmod 600 .env', 
        // Create startup script
        'log "Creating startup script"', 'cat > start_services_simple.sh << EOL', '#!/bin/bash', 'set -e', 'cd /home/ubuntu/demo_mcp_on_amazon_bedrock', '', '# Source environment', 'source .venv/bin/activate', 'export $(grep -v "^#" .env | xargs)', 'export PYTHONPATH=./src:$PYTHONPATH', '', '# Create log directories', 'mkdir -p logs', '', '# Function to start MCP service', 'start_mcp() {', '    echo "$(date): Starting MCP service"', '    python src/main.py \\', '        --mcp-conf conf/config.json \\', '        --user-conf conf/user_mcp_config.json \\', '        --host 127.0.0.1 \\', '        --port 7002 &', '    MCP_PID=$!', '    echo $MCP_PID > logs/mcp.pid', '    ', '    # Wait for MCP to be ready', '    for i in {1..30}; do', '        if curl -s http://127.0.0.1:7002/health > /dev/null 2>&1; then', '            echo "MCP service ready"', '            break', '        fi', '        sleep 2', '    done', '}', '', '# Function to start Streamlit', 'start_streamlit() {', '    echo "$(date): Starting Streamlit service"', '    streamlit run chatbot.py \\', '        --server.port 8502 \\', '        --server.address 0.0.0.0 \\', '        --server.headless true &', '    STREAMLIT_PID=$!', '    echo $STREAMLIT_PID > logs/streamlit.pid', '}', '', '# Cleanup function', 'cleanup() {', '    echo "Cleaning up processes..."', '    if [ -f logs/mcp.pid ]; then', '        kill $(cat logs/mcp.pid) 2>/dev/null || true', '    fi', '    if [ -f logs/streamlit.pid ]; then', '        kill $(cat logs/streamlit.pid) 2>/dev/null || true', '    fi', '    exit 0', '}', '', '# Set up signal handlers', 'trap cleanup SIGTERM SIGINT', '', '# Start services', 'start_mcp', 'start_streamlit', '', '# Keep the script running', 'echo "Services started, waiting..."', 'wait', 'EOL', 'chmod +x start_services_simple.sh', 'chown ubuntu:ubuntu start_services_simple.sh', 
        // Create systemd service
        'log "Creating systemd service"', 'cat > /etc/systemd/system/mcp-services.service << EOL', '[Unit]', 'Description=MCP Services (Local Code)', 'After=network-online.target', 'Wants=network-online.target', '', '[Service]', 'Type=simple', 'User=ubuntu', 'Group=ubuntu', 'Environment="HOME=/home/ubuntu"', 'Environment="PATH=/home/ubuntu/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"', 'WorkingDirectory=/home/ubuntu/demo_mcp_on_amazon_bedrock', 'ExecStart=/bin/bash /home/ubuntu/demo_mcp_on_amazon_bedrock/start_services_simple.sh', 'Restart=always', 'RestartSec=10', 'StandardOutput=journal', 'StandardError=journal', 'KillMode=mixed', 'TimeoutStartSec=120', '', '[Install]', 'WantedBy=multi-user.target', 'EOL', 
        // Enable and start service
        'log "Enabling and starting services"', 'systemctl daemon-reload', 'systemctl enable mcp-services', 'sleep 10', 'systemctl start mcp-services', 'sleep 15', 'systemctl status mcp-services >> /var/log/mcp-deployment.log 2>&1 || true', 'log "MCP deployment completed with local code"', 
        // Create health check script
        'cat > /home/ubuntu/check_services.sh << EOL', '#!/bin/bash', 'echo "=== Service Status ==="', 'systemctl status mcp-services --no-pager', 'echo "=== Process Status ==="', 'ps aux | grep -E "(python|streamlit)" | grep -v grep', 'echo "=== Port Status ==="', 'ss -tlnp | grep -E "(7002|8502)"', 'echo "=== Configuration ==="', 'cat /home/ubuntu/demo_mcp_on_amazon_bedrock/conf/config.json', 'echo "=== Recent Logs ==="', 'tail -20 /home/ubuntu/demo_mcp_on_amazon_bedrock/logs/*.log 2>/dev/null || echo "No logs found"', 'echo "=== Streamlit Health ==="', 'curl -s http://localhost:8502 > /dev/null && echo "Streamlit responding" || echo "Streamlit not responding"', 'EOL', 'chmod +x /home/ubuntu/check_services.sh', 'chown ubuntu:ubuntu /home/ubuntu/check_services.sh');
        // Create Launch Template
        const launchTemplate = new ec2.LaunchTemplate(this, `${prefix}-LaunchTemplate`, {
            instanceType: ec2.InstanceType.of(ec2.InstanceClass.C5, ec2.InstanceSize.XLARGE),
            machineImage: ec2.MachineImage.fromSsmParameter('/aws/service/canonical/ubuntu/server/22.04/stable/current/amd64/hvm/ebs-gp2/ami-id', { os: ec2.OperatingSystemType.LINUX }),
            userData,
            role,
            securityGroup: ec2Sg,
            blockDevices: [
                {
                    deviceName: '/dev/sda1',
                    volume: {
                        ebsDevice: {
                            volumeSize: 100,
                            volumeType: ec2.EbsDeviceVolumeType.GP3,
                        }
                    }
                }
            ],
        });
        // Create Auto Scaling Group
        const asg = new autoscaling.AutoScalingGroup(this, `${prefix}-ASG`, {
            vpc,
            launchTemplate,
            minCapacity: 1,
            maxCapacity: 1,
            vpcSubnets: {
                subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS
            }
        });
        // Add ASG as target for ALB
        streamlitListener.addTargets('Streamlit-Target', {
            port: 8502,
            protocol: elbv2.ApplicationProtocol.HTTP,
            targets: [asg],
            healthCheck: {
                path: '/',
                unhealthyThresholdCount: 3,
                healthyThresholdCount: 2,
                interval: cdk.Duration.seconds(30),
                timeout: cdk.Duration.seconds(10),
                healthyHttpCodes: '200,302'
            }
        });
        // Stack Outputs
        new cdk.CfnOutput(this, 'StreamlitEndpoint', {
            value: `http://${alb.loadBalancerDnsName}:8502`,
            description: 'Streamlit UI Endpoint'
        });
        new cdk.CfnOutput(this, 'AllowedCIDR', {
            value: allowedCidr,
            description: 'CIDR block allowed to access the application'
        });
        new cdk.CfnOutput(this, 'DeploymentMethod', {
            value: 'Git Clone from GitHub (with AWS CLI pre-installed)',
            description: 'How the application code is deployed'
        });
        new cdk.CfnOutput(this, 'Authentication', {
            value: 'Uses EC2 Instance Role (no API keys needed)',
            description: 'Authentication method'
        });
    }
}
exports.BedrockMcpStack = BedrockMcpStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmVkcm9jay1tY3Atc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvYmVkcm9jay1tY3Atc3RhY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsbUNBQW1DO0FBQ25DLDJDQUEyQztBQUMzQywyQ0FBMkM7QUFDM0MsZ0VBQWdFO0FBQ2hFLDJEQUEyRDtBQVEzRCxNQUFhLGVBQWdCLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFDNUMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUE0QjtRQUNwRSxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixNQUFNLE1BQU0sR0FBRyxLQUFLLEVBQUUsVUFBVSxJQUFJLEtBQUssQ0FBQztRQUMxQyxNQUFNLFdBQVcsR0FBRyxZQUFZLENBQUM7UUFFakMsYUFBYTtRQUNiLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxNQUFNLE1BQU0sRUFBRTtZQUM3QyxNQUFNLEVBQUUsQ0FBQztZQUNULFdBQVcsRUFBRSxDQUFDO1lBQ2QsbUJBQW1CLEVBQUU7Z0JBQ25CO29CQUNFLElBQUksRUFBRSxRQUFRO29CQUNkLFVBQVUsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLE1BQU07b0JBQ2pDLFFBQVEsRUFBRSxFQUFFO2lCQUNiO2dCQUNEO29CQUNFLElBQUksRUFBRSxTQUFTO29CQUNmLFVBQVUsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLG1CQUFtQjtvQkFDOUMsUUFBUSxFQUFFLEVBQUU7aUJBQ2I7YUFDRjtTQUNGLENBQUMsQ0FBQztRQUVILGdDQUFnQztRQUNoQyxNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLEdBQUcsTUFBTSxTQUFTLEVBQUU7WUFDNUQsR0FBRztZQUNILGdCQUFnQixFQUFFLElBQUk7WUFDdEIsV0FBVyxFQUFFLDhD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Q0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLGFBQWEsRUFBRTtZQUNyQyxLQUFLLEVBQUUsV0FBVztZQUNsQixXQUFXLEVBQUUsOENBQThDO1NBQzVELENBQUMsQ0FBQztRQUVILElBQUksR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsa0JBQWtCLEVBQUU7WUFDMUMsS0FBSyxFQUFFLG9EQUFvRDtZQUMzRCxXQUFXLEVBQUUsc0NBQXNDO1NBQ3BELENBQUMsQ0FBQztRQUVILElBQUksR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLEVBQUU7WUFDeEMsS0FBSyxFQUFFLDZDQUE2QztZQUNwRCxXQUFXLEVBQUUsdUJBQXVCO1NBQ3JDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQTVZRCwwQ0E0WUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjZGsgZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0ICogYXMgZWMyIGZyb20gJ2F3cy1jZGstbGliL2F3cy1lYzInO1xuaW1wb3J0ICogYXMgaWFtIGZyb20gJ2F3cy1jZGstbGliL2F3cy1pYW0nO1xuaW1wb3J0ICogYXMgZWxidjIgZnJvbSAnYXdzLWNkay1saWIvYXdzLWVsYXN0aWNsb2FkYmFsYW5jaW5ndjInO1xuaW1wb3J0ICogYXMgYXV0b3NjYWxpbmcgZnJvbSAnYXdzLWNkay1saWIvYXdzLWF1dG9zY2FsaW5nJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJlZHJvY2tNY3BTdGFja1Byb3BzIGV4dGVuZHMgY2RrLlN0YWNrUHJvcHMge1xuICBuYW1lUHJlZml4Pzogc3RyaW5nO1xuICBhbGxvd2VkQ2lkcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEJlZHJvY2tNY3BTdGFjayBleHRlbmRzIGNkay5TdGFjayB7XG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzPzogQmVkcm9ja01jcFN0YWNrUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHByb3BzKTtcblxuICAgIGNvbnN0IHByZWZpeCA9IHByb3BzPy5uYW1lUHJlZml4IHx8ICdNQ1AnO1xuICAgIGNvbnN0IGFsbG93ZWRDaWRyID0gJzQuMC4wLjAvMjMnO1xuXG4gICAgLy8gQ3JlYXRlIFZQQ1xuICAgIGNvbnN0IHZwYyA9IG5ldyBlYzIuVnBjKHRoaXMsIGAke3ByZWZpeH0tVlBDYCwge1xuICAgICAgbWF4QXpzOiAyLFxuICAgICAgbmF0R2F0ZXdheXM6IDEsXG4gICAgICBzdWJuZXRDb25maWd1cmF0aW9uOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnUHVibGljJyxcbiAgICAgICAgICBzdWJuZXRUeXBlOiBlYzIuU3VibmV0VHlwZS5QVUJMSUMsXG4gICAgICAgICAgY2lkck1hc2s6IDI0LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ1ByaXZhdGUnLFxuICAgICAgICAgIHN1Ym5ldFR5cGU6IGVjMi5TdWJuZXRUeXBlLlBSSVZBVEVfV0lUSF9FR1JFU1MsXG4gICAgICAgICAgY2lkck1hc2s6IDI0LFxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgU2VjdXJpdHkgR3JvdXAgZm9yIEFMQlxuICAgIGNvbnN0IGFsYlNnID0gbmV3IGVjMi5TZWN1cml0eUdyb3VwKHRoaXMsIGAke3ByZWZpeH0tQUxCLVNHYCwge1xuICAgICAgdnBjLFxuICAgICAgYWxsb3dBbGxPdXRib3VuZDogdHJ1ZSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnU2VjdXJpdHkgZ3JvdXAgZm9yIEFwcGxpY2F0aW9uIExvYWQgQmFsYW5jZXInLFxuICAgICAgZGlzYWJsZUlubGluZVJ1bGVzOiB0cnVlXG4gICAgfSk7XG5cbiAgICBhbGJTZy5hZGRJbmdyZXNzUnVsZShcbiAgICAgIGVjMi5QZWVyLmlwdjQoYWxsb3dlZENpZHIpLFxuICAgICAgZWMyLlBvcnQudGNwKDg1MDIpLFxuICAgICAgYFN0cmVhbWxpdCBVSSBhY2Nlc3MgZnJvbSAke2FsbG93ZWRDaWRyfWBcbiAgICApO1xuXG4gICAgLy8gQ3JlYXRlIFNlY3VyaXR5IEdyb3VwIGZvciBFQzJcbiAgICBjb25zdCBlYzJTZyA9IG5ldyBlYzIuU2VjdXJpdHlHcm91cCh0aGlzLCBgJHtwcmVmaXh9LUVDMi1TR2AsIHtcbiAgICAgIHZwYyxcbiAgICAgIGFsbG93QWxsT3V0Ym91bmQ6IHRydWUsXG4gICAgICBkZXNjcmlwdGlvbjogJ1NlY3VyaXR5IGdyb3VwIGZvciBFQzIgaW5zdGFuY2VzJ1xuICAgIH0pO1xuXG4gICAgZWMyU2cuYWRkSW5ncmVzc1J1bGUoXG4gICAgICBlYzIuUGVlci5zZWN1cml0eUdyb3VwSWQoYWxiU2cuc2VjdXJpdHlHcm91cElkKSxcbiAgICAgIGVjMi5Qb3J0LnRjcCg4NTAyKSxcbiAgICAgICdTdHJlYW1saXQgVUkgZnJvbSBBTEInXG4gICAgKTtcblxuICAgIC8vIENyZWF0ZSBJQU0gUm9sZVxuICAgIGNvbnN0IHJvbGUgPSBuZXcgaWFtLlJvbGUodGhpcywgJ0VDMi1Sb2xlJywge1xuICAgICAgYXNzdW1lZEJ5OiBuZXcgaWFtLlNlcnZpY2VQcmluY2lwYWwoJ2VjMi5hbWF6b25hd3MuY29tJyksXG4gICAgICBtYW5hZ2VkUG9saWNpZXM6IFtcbiAgICAgICAgaWFtLk1hbmFnZWRQb2xpY3kuZnJvbUF3c01hbmFnZWRQb2xpY3lOYW1lKCdBbWF6b25TU01NYW5hZ2VkSW5zdGFuY2VDb3JlJylcbiAgICAgIF1cbiAgICB9KTtcblxuICAgIC8vIEFkZCBCZWRyb2NrIHBlcm1pc3Npb25zXG4gICAgcm9sZS5hZGRUb1BvbGljeShuZXcgaWFtLlBvbGljeVN0YXRlbWVudCh7XG4gICAgICBlZmZlY3Q6IGlhbS5FZmZlY3QuQUxMT1csXG4gICAgICBhY3Rpb25zOiBbXG4gICAgICAgICdiZWRyb2NrOkludm9rZU1vZGVsKicsXG4gICAgICAgICdiZWRyb2NrOkxpc3RGb3VuZGF0aW9uTW9kZWxzJ1xuICAgICAgXSxcbiAgICAgIHJlc291cmNlczogWycqJ11cbiAgICB9KSk7XG5cbiAgICAvLyBDcmVhdGUgQXBwbGljYXRpb24gTG9hZCBCYWxhbmNlclxuICAgIGNvbnN0IGFsYiA9IG5ldyBlbGJ2Mi5BcHBsaWNhdGlvbkxvYWRCYWxhbmNlcih0aGlzLCBgJHtwcmVmaXh9LUFMQmAsIHtcbiAgICAgIHZwYyxcbiAgICAgIGludGVybmV0RmFjaW5nOiB0cnVlLFxuICAgICAgc2VjdXJpdHlHcm91cDogYWxiU2dcbiAgICB9KTtcblxuICAgIGNvbnN0IHN0cmVhbWxpdExpc3RlbmVyID0gYWxiLmFkZExpc3RlbmVyKCdTdHJlYW1saXQnLCB7IFxuICAgICAgcG9ydDogODUwMixcbiAgICAgIHByb3RvY29sOiBlbGJ2Mi5BcHBsaWNhdGlvblByb3RvY29sLkhUVFAsXG4gICAgICBvcGVuOiBmYWxzZVxuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIFVzZXIgRGF0YSB0aGF0IGRvd25sb2FkcyBsb2NhbCBjb2RlIGZyb20gUzNcbiAgICBjb25zdCB1c2VyRGF0YSA9IGVjMi5Vc2VyRGF0YS5mb3JMaW51eCgpO1xuICAgIHVzZXJEYXRhLmFkZENvbW1hbmRzKFxuICAgICAgJyMhL2Jpbi9iYXNoJyxcbiAgICAgICdzZXQgLWUnLFxuICAgICAgXG4gICAgICAvLyBMb2dnaW5nIGZ1bmN0aW9uXG4gICAgICAnbG9nKCkgeyBlY2hvIFwiJChkYXRlKTogJDFcIiB8IHRlZSAtYSAvdmFyL2xvZy9tY3AtZGVwbG95bWVudC5sb2c7IH0nLFxuICAgICAgJ2xvZyBcIlN0YXJ0aW5nIE1DUCBkZXBsb3ltZW50IHdpdGggbG9jYWwgY29kZVwiJyxcbiAgICAgIFxuICAgICAgLy8gU2V0IGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAgJ2V4cG9ydCBIT01FPS9yb290JyxcbiAgICAgICdleHBvcnQgUEFUSD1cIi91c3IvbG9jYWwvYmluOiRQQVRIXCInLFxuICAgICAgJ2V4cG9ydCBERUJJQU5fRlJPTlRFTkQ9bm9uaW50ZXJhY3RpdmUnLFxuICAgICAgXG4gICAgICAvLyBVcGRhdGUgc3lzdGVtIGFuZCBpbnN0YWxsIGRlcGVuZGVuY2llc1xuICAgICAgJ2xvZyBcIlVwZGF0aW5nIHN5c3RlbSBwYWNrYWdlc1wiJyxcbiAgICAgICdhcHQtZ2V0IHVwZGF0ZSAteScsXG4gICAgICAnYXB0LWdldCBpbnN0YWxsIC15IHNvZnR3YXJlLXByb3BlcnRpZXMtY29tbW9uIGN1cmwgd2dldCBnaXQgYnVpbGQtZXNzZW50aWFsIHVuemlwJyxcbiAgICAgIFxuICAgICAgLy8gSW5zdGFsbCBBV1MgQ0xJIGZpcnN0ICh0aGlzIHdhcyB0aGUgbWlzc2luZyBwaWVjZSEpXG4gICAgICAnbG9nIFwiSW5zdGFsbGluZyBBV1MgQ0xJXCInLFxuICAgICAgJ2N1cmwgXCJodHRwczovL2F3c2NsaS5hbWF6b25hd3MuY29tL2F3c2NsaS1leGUtbGludXgteDg2XzY0LnppcFwiIC1vIFwiYXdzY2xpdjIuemlwXCInLFxuICAgICAgJ3VuemlwIGF3c2NsaXYyLnppcCcsXG4gICAgICAnLi9hd3MvaW5zdGFsbCcsXG4gICAgICAncm0gLXJmIGF3cyBhd3NjbGl2Mi56aXAnLFxuICAgICAgXG4gICAgICAvLyBJbnN0YWxsIFB5dGhvbiAzLjEyXG4gICAgICAnbG9nIFwiSW5zdGFsbGluZyBQeXRob24gMy4xMlwiJyxcbiAgICAgICdhZGQtYXB0LXJlcG9zaXRvcnkgLXkgcHBhOmRlYWRzbmFrZXMvcHBhJyxcbiAgICAgICdhcHQtZ2V0IHVwZGF0ZSAteScsXG4gICAgICAnYXB0LWdldCBpbnN0YWxsIC15IHB5dGhvbjMuMTIgcHl0aG9uMy4xMi12ZW52IHB5dGhvbjMuMTItZGV2IHB5dGhvbjMtcGlwJyxcbiAgICAgIFxuICAgICAgLy8gSW5zdGFsbCBOb2RlLmpzXG4gICAgICAnbG9nIFwiSW5zdGFsbGluZyBOb2RlLmpzXCInLFxuICAgICAgJ2N1cmwgLWZzU0wgaHR0cHM6Ly9kZWIubm9kZXNvdXJjZS5jb20vc2V0dXBfMjIueCB8IGJhc2ggLScsXG4gICAgICAnYXB0LWdldCBpbnN0YWxsIC15IG5vZGVqcycsXG4gICAgICBcbiAgICAgIC8vIEluc3RhbGwgc3lzdGVtIGRlcGVuZGVuY2llc1xuICAgICAgJ2xvZyBcIkluc3RhbGxpbmcgc3lzdGVtIGRlcGVuZGVuY2llc1wiJyxcbiAgICAgICdhcHQtZ2V0IGluc3RhbGwgLXkgcG9ydGF1ZGlvMTktZGV2IGxpYmFzb3VuZDItZGV2IGxpYnBvcnRhdWRpbzIgbGlicG9ydGF1ZGlvY3BwMCcsXG4gICAgICBcbiAgICAgIC8vIFNldHVwIHVidW50dSB1c2VyIGVudmlyb25tZW50XG4gICAgICAnbG9nIFwiU2V0dGluZyB1cCB1YnVudHUgdXNlciBlbnZpcm9ubWVudFwiJyxcbiAgICAgICdzdSAtIHVidW50dSAtYyBcImN1cmwgLUxzU2YgaHR0cHM6Ly9hc3RyYWwuc2gvdXYvaW5zdGFsbC5zaCB8IHNoXCInLFxuICAgICAgJ2VjaG8gXFwnZXhwb3J0IFBBVEg9XCIvaG9tZS91YnVudHUvLmxvY2FsL2JpbjokUEFUSFwiXFwnID4+IC9ob21lL3VidW50dS8uYmFzaHJjJyxcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHByb2plY3QgZGlyZWN0b3J5XG4gICAgICAnbG9nIFwiQ3JlYXRpbmcgcHJvamVjdCBkaXJlY3RvcnlcIicsXG4gICAgICAnbWtkaXIgLXAgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrJyxcbiAgICAgICdjaG93biB1YnVudHU6dWJ1bnR1IC9ob21lL3VidW50dS9kZW1vX21jcF9vbl9hbWF6b25fYmVkcm9jaycsXG4gICAgICAnY2QgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrJyxcbiAgICAgIFxuICAgICAgLy8gVXNlIGdpdCBjbG9uZSBhcHByb2FjaCAobW9yZSByZWxpYWJsZSB0aGFuIFMzKVxuICAgICAgJ2xvZyBcIkNsb25pbmcgYXBwbGljYXRpb24gY29kZSBmcm9tIEdpdEh1YlwiJyxcbiAgICAgICdzdSAtIHVidW50dSAtYyBcImNkIC9ob21lL3VidW50dSAmJiBnaXQgY2xvbmUgaHR0cHM6Ly9naXRodWIuY29tL2hjd29uZ2xlby9kZW1vLW1jcC1iZWRyb2NrLmdpdCBkZW1vX21jcF9vbl9hbWF6b25fYmVkcm9ja1wiJyxcbiAgICAgICdjZCAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgXG4gICAgICAvLyBPdmVycmlkZSBjb25maWcgd2l0aCBOb3ZhIFBybyBvbmx5XG4gICAgICAnbG9nIFwiQ29uZmlndXJpbmcgTm92YSBQcm8gb25seSBtb2RlbFwiJyxcbiAgICAgICdjYXQgPiBjb25mL2NvbmZpZy5qc29uIDw8IEVPTCcsXG4gICAgICAneycsXG4gICAgICAnXFx0XCJtb2RlbHNcIjogWycsXG4gICAgICAnXFx0XFx0eycsXG4gICAgICAnXFx0XFx0XFx0XCJtb2RlbF9pZFwiOiBcInVzLmFtYXpvbi5ub3ZhLXByby12MTowXCIsJyxcbiAgICAgICdcXHRcXHRcXHRcIm1vZGVsX25hbWVcIjogXCJBbWF6b24gTm92YSBQcm8gdjFcIicsXG4gICAgICAnXFx0XFx0fScsXG4gICAgICAnXFx0XSwnLFxuICAgICAgJ1xcdFwibWNwU2VydmVyc1wiOiB7JyxcbiAgICAgICdcXHR9JyxcbiAgICAgICd9JyxcbiAgICAgICdFT0wnLFxuICAgICAgXG4gICAgICAvLyBTZXQgcHJvcGVyIG93bmVyc2hpcFxuICAgICAgJ2Nob3duIC1SIHVidW50dTp1YnVudHUgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrJyxcbiAgICAgICdjaG1vZCA3NTUgL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrJyxcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIG5lY2Vzc2FyeSBkaXJlY3Rvcmllc1xuICAgICAgJ2xvZyBcIkNyZWF0aW5nIG5lY2Vzc2FyeSBkaXJlY3Rvcmllc1wiJyxcbiAgICAgICdta2RpciAtcCBsb2dzIHRtcCcsXG4gICAgICAnY2hvd24gLVIgdWJ1bnR1OnVidW50dSBsb2dzIHRtcCcsXG4gICAgICBcbiAgICAgIC8vIFJlbW92ZSBOb3ZhIFNvbmljIGNvbXBvbmVudHMgaWYgdGhleSBleGlzdFxuICAgICAgJ2xvZyBcIlJlbW92aW5nIE5vdmEgU29uaWMgY29tcG9uZW50c1wiJyxcbiAgICAgICdybSAtZiBzcmMvbm92YV9zb25pY19tYW5hZ2VyLnB5IHNyYy93ZWJzb2NrZXRfbWFuYWdlci5weSB8fCB0cnVlJyxcbiAgICAgIFxuICAgICAgLy8gU2V0dXAgUHl0aG9uIGVudmlyb25tZW50XG4gICAgICAnbG9nIFwiU2V0dGluZyB1cCBQeXRob24gZW52aXJvbm1lbnRcIicsXG4gICAgICAnc3UgLSB1YnVudHUgLWMgXCInLFxuICAgICAgJ2NkIC9ob21lL3VidW50dS9kZW1vX21jcF9vbl9hbWF6b25fYmVkcm9jayAmJiBcXFxcJyxcbiAgICAgICdleHBvcnQgUEFUSD1cXFwiL2hvbWUvdWJ1bnR1Ly5sb2NhbC9iaW46JFBBVEhcXFwiICYmIFxcXFwnLFxuICAgICAgJ3B5dGhvbjMuMTIgLW0gdmVudiAudmVudiAmJiBcXFxcJyxcbiAgICAgICdzb3VyY2UgLnZlbnYvYmluL2FjdGl2YXRlICYmIFxcXFwnLFxuICAgICAgJ3BpcCBpbnN0YWxsIC0tdXBncmFkZSBwaXAgJiYgXFxcXCcsXG4gICAgICAncGlwIGluc3RhbGwgdXYgJiYgXFxcXCcsXG4gICAgICAndXYgc3luYyAtLW5vLWRldiB8fCBwaXAgaW5zdGFsbCBib3RvMyBib3RvY29yZSBmYXN0YXBpIHV2aWNvcm4gbWNwIG9wZW5haSBhaW9odHRwIHB5dGhvbi1kb3RlbnYgcmVxdWVzdHMgcGFuZGFzIHB5dHogcnggc3RyZWFtbGl0IHN0cmVhbWxpdC1jb29raWVzLWNvbnRyb2xsZXIgc3RyZWFtbGl0LWxvY2FsLXN0b3JhZ2UgdHpkYXRhIHV2aWNvcm4gd2Vic29ja2V0cycsXG4gICAgICAnXCInLFxuICAgICAgXG4gICAgICAvLyBDb25maWd1cmUgZW52aXJvbm1lbnQgKHVzaW5nIGluc3RhbmNlIHJvbGUgb25seSlcbiAgICAgICdsb2cgXCJDb25maWd1cmluZyBlbnZpcm9ubWVudFwiJyxcbiAgICAgICdjYXQgPiAuZW52IDw8IEVPTCcsXG4gICAgICAnQVdTX1JFR0lPTj0nICsgY2RrLlN0YWNrLm9mKHRoaXMpLnJlZ2lvbixcbiAgICAgICdMT0dfRElSPS4vbG9ncycsXG4gICAgICAnQ0hBVEJPVF9TRVJWSUNFX1BPUlQ9ODUwMicsXG4gICAgICAnTUNQX1NFUlZJQ0VfSE9TVD0xMjcuMC4wLjEnLFxuICAgICAgJ01DUF9TRVJWSUNFX1BPUlQ9NzAwMicsXG4gICAgICAnTUNQX0JBU0VfVVJMPWh0dHA6Ly8xMjcuMC4wLjE6NzAwMicsXG4gICAgICBgQVBJX0tFWT0ke2Nkay5OYW1lcy51bmlxdWVJZCh0aGlzKX1gLFxuICAgICAgJ0VPTCcsXG4gICAgICAnY2hvd24gdWJ1bnR1OnVidW50dSAuZW52JyxcbiAgICAgICdjaG1vZCA2MDAgLmVudicsXG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBzdGFydHVwIHNjcmlwdFxuICAgICAgJ2xvZyBcIkNyZWF0aW5nIHN0YXJ0dXAgc2NyaXB0XCInLFxuICAgICAgJ2NhdCA+IHN0YXJ0X3NlcnZpY2VzX3NpbXBsZS5zaCA8PCBFT0wnLFxuICAgICAgJyMhL2Jpbi9iYXNoJyxcbiAgICAgICdzZXQgLWUnLFxuICAgICAgJ2NkIC9ob21lL3VidW50dS9kZW1vX21jcF9vbl9hbWF6b25fYmVkcm9jaycsXG4gICAgICAnJyxcbiAgICAgICcjIFNvdXJjZSBlbnZpcm9ubWVudCcsXG4gICAgICAnc291cmNlIC52ZW52L2Jpbi9hY3RpdmF0ZScsXG4gICAgICAnZXhwb3J0ICQoZ3JlcCAtdiBcIl4jXCIgLmVudiB8IHhhcmdzKScsXG4gICAgICAnZXhwb3J0IFBZVEhPTlBBVEg9Li9zcmM6JFBZVEhPTlBBVEgnLFxuICAgICAgJycsXG4gICAgICAnIyBDcmVhdGUgbG9nIGRpcmVjdG9yaWVzJyxcbiAgICAgICdta2RpciAtcCBsb2dzJyxcbiAgICAgICcnLFxuICAgICAgJyMgRnVuY3Rpb24gdG8gc3RhcnQgTUNQIHNlcnZpY2UnLFxuICAgICAgJ3N0YXJ0X21jcCgpIHsnLFxuICAgICAgJyAgICBlY2hvIFwiJChkYXRlKTogU3RhcnRpbmcgTUNQIHNlcnZpY2VcIicsXG4gICAgICAnICAgIHB5dGhvbiBzcmMvbWFpbi5weSBcXFxcJyxcbiAgICAgICcgICAgICAgIC0tbWNwLWNvbmYgY29uZi9jb25maWcuanNvbiBcXFxcJyxcbiAgICAgICcgICAgICAgIC0tdXNlci1jb25mIGNvbmYvdXNlcl9tY3BfY29uZmlnLmpzb24gXFxcXCcsXG4gICAgICAnICAgICAgICAtLWhvc3QgMTI3LjAuMC4xIFxcXFwnLFxuICAgICAgJyAgICAgICAgLS1wb3J0IDcwMDIgJicsXG4gICAgICAnICAgIE1DUF9QSUQ9JCEnLFxuICAgICAgJyAgICBlY2hvICRNQ1BfUElEID4gbG9ncy9tY3AucGlkJyxcbiAgICAgICcgICAgJyxcbiAgICAgICcgICAgIyBXYWl0IGZvciBNQ1AgdG8gYmUgcmVhZHknLFxuICAgICAgJyAgICBmb3IgaSBpbiB7MS4uMzB9OyBkbycsXG4gICAgICAnICAgICAgICBpZiBjdXJsIC1zIGh0dHA6Ly8xMjcuMC4wLjE6NzAwMi9oZWFsdGggPiAvZGV2L251bGwgMj4mMTsgdGhlbicsXG4gICAgICAnICAgICAgICAgICAgZWNobyBcIk1DUCBzZXJ2aWNlIHJlYWR5XCInLFxuICAgICAgJyAgICAgICAgICAgIGJyZWFrJyxcbiAgICAgICcgICAgICAgIGZpJyxcbiAgICAgICcgICAgICAgIHNsZWVwIDInLFxuICAgICAgJyAgICBkb25lJyxcbiAgICAgICd9JyxcbiAgICAgICcnLFxuICAgICAgJyMgRnVuY3Rpb24gdG8gc3RhcnQgU3RyZWFtbGl0JyxcbiAgICAgICdzdGFydF9zdHJlYW1saXQoKSB7JyxcbiAgICAgICcgICAgZWNobyBcIiQoZGF0ZSk6IFN0YXJ0aW5nIFN0cmVhbWxpdCBzZXJ2aWNlXCInLFxuICAgICAgJyAgICBzdHJlYW1saXQgcnVuIGNoYXRib3QucHkgXFxcXCcsXG4gICAgICAnICAgICAgICAtLXNlcnZlci5wb3J0IDg1MDIgXFxcXCcsXG4gICAgICAnICAgICAgICAtLXNlcnZlci5hZGRyZXNzIDAuMC4wLjAgXFxcXCcsXG4gICAgICAnICAgICAgICAtLXNlcnZlci5oZWFkbGVzcyB0cnVlICYnLFxuICAgICAgJyAgICBTVFJFQU1MSVRfUElEPSQhJyxcbiAgICAgICcgICAgZWNobyAkU1RSRUFNTElUX1BJRCA+IGxvZ3Mvc3RyZWFtbGl0LnBpZCcsXG4gICAgICAnfScsXG4gICAgICAnJyxcbiAgICAgICcjIENsZWFudXAgZnVuY3Rpb24nLFxuICAgICAgJ2NsZWFudXAoKSB7JyxcbiAgICAgICcgICAgZWNobyBcIkNsZWFuaW5nIHVwIHByb2Nlc3Nlcy4uLlwiJyxcbiAgICAgICcgICAgaWYgWyAtZiBsb2dzL21jcC5waWQgXTsgdGhlbicsXG4gICAgICAnICAgICAgICBraWxsICQoY2F0IGxvZ3MvbWNwLnBpZCkgMj4vZGV2L251bGwgfHwgdHJ1ZScsXG4gICAgICAnICAgIGZpJyxcbiAgICAgICcgICAgaWYgWyAtZiBsb2dzL3N0cmVhbWxpdC5waWQgXTsgdGhlbicsXG4gICAgICAnICAgICAgICBraWxsICQoY2F0IGxvZ3Mvc3RyZWFtbGl0LnBpZCkgMj4vZGV2L251bGwgfHwgdHJ1ZScsXG4gICAgICAnICAgIGZpJyxcbiAgICAgICcgICAgZXhpdCAwJyxcbiAgICAgICd9JyxcbiAgICAgICcnLFxuICAgICAgJyMgU2V0IHVwIHNpZ25hbCBoYW5kbGVycycsXG4gICAgICAndHJhcCBjbGVhbnVwIFNJR1RFUk0gU0lHSU5UJyxcbiAgICAgICcnLFxuICAgICAgJyMgU3RhcnQgc2VydmljZXMnLFxuICAgICAgJ3N0YXJ0X21jcCcsXG4gICAgICAnc3RhcnRfc3RyZWFtbGl0JyxcbiAgICAgICcnLFxuICAgICAgJyMgS2VlcCB0aGUgc2NyaXB0IHJ1bm5pbmcnLFxuICAgICAgJ2VjaG8gXCJTZXJ2aWNlcyBzdGFydGVkLCB3YWl0aW5nLi4uXCInLFxuICAgICAgJ3dhaXQnLFxuICAgICAgJ0VPTCcsXG4gICAgICBcbiAgICAgICdjaG1vZCAreCBzdGFydF9zZXJ2aWNlc19zaW1wbGUuc2gnLFxuICAgICAgJ2Nob3duIHVidW50dTp1YnVudHUgc3RhcnRfc2VydmljZXNfc2ltcGxlLnNoJyxcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHN5c3RlbWQgc2VydmljZVxuICAgICAgJ2xvZyBcIkNyZWF0aW5nIHN5c3RlbWQgc2VydmljZVwiJyxcbiAgICAgICdjYXQgPiAvZXRjL3N5c3RlbWQvc3lzdGVtL21jcC1zZXJ2aWNlcy5zZXJ2aWNlIDw8IEVPTCcsXG4gICAgICAnW1VuaXRdJyxcbiAgICAgICdEZXNjcmlwdGlvbj1NQ1AgU2VydmljZXMgKExvY2FsIENvZGUpJyxcbiAgICAgICdBZnRlcj1uZXR3b3JrLW9ubGluZS50YXJnZXQnLFxuICAgICAgJ1dhbnRzPW5ldHdvcmstb25saW5lLnRhcmdldCcsXG4gICAgICAnJyxcbiAgICAgICdbU2VydmljZV0nLFxuICAgICAgJ1R5cGU9c2ltcGxlJyxcbiAgICAgICdVc2VyPXVidW50dScsXG4gICAgICAnR3JvdXA9dWJ1bnR1JyxcbiAgICAgICdFbnZpcm9ubWVudD1cIkhPTUU9L2hvbWUvdWJ1bnR1XCInLFxuICAgICAgJ0Vudmlyb25tZW50PVwiUEFUSD0vaG9tZS91YnVudHUvLmxvY2FsL2JpbjovdXNyL2xvY2FsL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9zYmluOi91c3IvYmluOi9zYmluOi9iaW5cIicsXG4gICAgICAnV29ya2luZ0RpcmVjdG9yeT0vaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2snLFxuICAgICAgJ0V4ZWNTdGFydD0vYmluL2Jhc2ggL2hvbWUvdWJ1bnR1L2RlbW9fbWNwX29uX2FtYXpvbl9iZWRyb2NrL3N0YXJ0X3NlcnZpY2VzX3NpbXBsZS5zaCcsXG4gICAgICAnUmVzdGFydD1hbHdheXMnLFxuICAgICAgJ1Jlc3RhcnRTZWM9MTAnLFxuICAgICAgJ1N0YW5kYXJkT3V0cHV0PWpvdXJuYWwnLFxuICAgICAgJ1N0YW5kYXJkRXJyb3I9am91cm5hbCcsXG4gICAgICAnS2lsbE1vZGU9bWl4ZWQnLFxuICAgICAgJ1RpbWVvdXRTdGFydFNlYz0xMjAnLFxuICAgICAgJycsXG4gICAgICAnW0luc3RhbGxdJyxcbiAgICAgICdXYW50ZWRCeT1tdWx0aS11c2VyLnRhcmdldCcsXG4gICAgICAnRU9MJyxcbiAgICAgIFxuICAgICAgLy8gRW5hYmxlIGFuZCBzdGFydCBzZXJ2aWNlXG4gICAgICAnbG9nIFwiRW5hYmxpbmcgYW5kIHN0YXJ0aW5nIHNlcnZpY2VzXCInLFxuICAgICAgJ3N5c3RlbWN0bCBkYWVtb24tcmVsb2FkJyxcbiAgICAgICdzeXN0ZW1jdGwgZW5hYmxlIG1jcC1zZXJ2aWNlcycsXG4gICAgICAnc2xlZXAgMTAnLFxuICAgICAgJ3N5c3RlbWN0bCBzdGFydCBtY3Atc2VydmljZXMnLFxuICAgICAgJ3NsZWVwIDE1JyxcbiAgICAgICdzeXN0ZW1jdGwgc3RhdHVzIG1jcC1zZXJ2aWNlcyA+PiAvdmFyL2xvZy9tY3AtZGVwbG95bWVudC5sb2cgMj4mMSB8fCB0cnVlJyxcbiAgICAgICdsb2cgXCJNQ1AgZGVwbG95bWVudCBjb21wbGV0ZWQgd2l0aCBsb2NhbCBjb2RlXCInLFxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgaGVhbHRoIGNoZWNrIHNjcmlwdFxuICAgICAgJ2NhdCA+IC9ob21lL3VidW50dS9jaGVja19zZXJ2aWNlcy5zaCA8PCBFT0wnLFxuICAgICAgJyMhL2Jpbi9iYXNoJyxcbiAgICAgICdlY2hvIFwiPT09IFNlcnZpY2UgU3RhdHVzID09PVwiJyxcbiAgICAgICdzeXN0ZW1jdGwgc3RhdHVzIG1jcC1zZXJ2aWNlcyAtLW5vLXBhZ2VyJyxcbiAgICAgICdlY2hvIFwiPT09IFByb2Nlc3MgU3RhdHVzID09PVwiJyxcbiAgICAgICdwcyBhdXggfCBncmVwIC1FIFwiKHB5dGhvbnxzdHJlYW1saXQpXCIgfCBncmVwIC12IGdyZXAnLFxuICAgICAgJ2VjaG8gXCI9PT0gUG9ydCBTdGF0dXMgPT09XCInLFxuICAgICAgJ3NzIC10bG5wIHwgZ3JlcCAtRSBcIig3MDAyfDg1MDIpXCInLFxuICAgICAgJ2VjaG8gXCI9PT0gQ29uZmlndXJhdGlvbiA9PT1cIicsXG4gICAgICAnY2F0IC9ob21lL3VidW50dS9kZW1vX21jcF9vbl9hbWF6b25fYmVkcm9jay9jb25mL2NvbmZpZy5qc29uJyxcbiAgICAgICdlY2hvIFwiPT09IFJlY2VudCBMb2dzID09PVwiJyxcbiAgICAgICd0YWlsIC0yMCAvaG9tZS91YnVudHUvZGVtb19tY3Bfb25fYW1hem9uX2JlZHJvY2svbG9ncy8qLmxvZyAyPi9kZXYvbnVsbCB8fCBlY2hvIFwiTm8gbG9ncyBmb3VuZFwiJyxcbiAgICAgICdlY2hvIFwiPT09IFN0cmVhbWxpdCBIZWFsdGggPT09XCInLFxuICAgICAgJ2N1cmwgLXMgaHR0cDovL2xvY2FsaG9zdDo4NTAyID4gL2Rldi9udWxsICYmIGVjaG8gXCJTdHJlYW1saXQgcmVzcG9uZGluZ1wiIHx8IGVjaG8gXCJTdHJlYW1saXQgbm90IHJlc3BvbmRpbmdcIicsXG4gICAgICAnRU9MJyxcbiAgICAgICdjaG1vZCAreCAvaG9tZS91YnVudHUvY2hlY2tfc2VydmljZXMuc2gnLFxuICAgICAgJ2Nob3duIHVidW50dTp1YnVudHUgL2hvbWUvdWJ1bnR1L2NoZWNrX3NlcnZpY2VzLnNoJ1xuICAgICk7XG5cbiAgICAvLyBDcmVhdGUgTGF1bmNoIFRlbXBsYXRlXG4gICAgY29uc3QgbGF1bmNoVGVtcGxhdGUgPSBuZXcgZWMyLkxhdW5jaFRlbXBsYXRlKHRoaXMsIGAke3ByZWZpeH0tTGF1bmNoVGVtcGxhdGVgLCB7XG4gICAgICBpbnN0YW5jZVR5cGU6IGVjMi5JbnN0YW5jZVR5cGUub2YoZWMyLkluc3RhbmNlQ2xhc3MuQzUsIGVjMi5JbnN0YW5jZVNpemUuWExBUkdFKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogZWMyLk1hY2hpbmVJbWFnZS5mcm9tU3NtUGFyYW1ldGVyKFxuICAgICAgICAnL2F3cy9zZXJ2aWNlL2Nhbm9uaWNhbC91YnVudHUvc2VydmVyLzIyLjA0L3N0YWJsZS9jdXJyZW50L2FtZDY0L2h2bS9lYnMtZ3AyL2FtaS1pZCcsXG4gICAgICAgIHsgb3M6IGVjMi5PcGVyYXRpbmdTeXN0ZW1UeXBlLkxJTlVYIH1cbiAgICAgICksXG4gICAgICB1c2VyRGF0YSxcbiAgICAgIHJvbGUsXG4gICAgICBzZWN1cml0eUdyb3VwOiBlYzJTZyxcbiAgICAgIGJsb2NrRGV2aWNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgZGV2aWNlTmFtZTogJy9kZXYvc2RhMScsXG4gICAgICAgICAgdm9sdW1lOiB7XG4gICAgICAgICAgICBlYnNEZXZpY2U6IHtcbiAgICAgICAgICAgICAgdm9sdW1lU2l6ZTogMTAwLFxuICAgICAgICAgICAgICB2b2x1bWVUeXBlOiBlYzIuRWJzRGV2aWNlVm9sdW1lVHlwZS5HUDMsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdLFxuICAgIH0pO1xuICAgIFxuICAgIC8vIENyZWF0ZSBBdXRvIFNjYWxpbmcgR3JvdXBcbiAgICBjb25zdCBhc2cgPSBuZXcgYXV0b3NjYWxpbmcuQXV0b1NjYWxpbmdHcm91cCh0aGlzLCBgJHtwcmVmaXh9LUFTR2AsIHtcbiAgICAgIHZwYyxcbiAgICAgIGxhdW5jaFRlbXBsYXRlLFxuICAgICAgbWluQ2FwYWNpdHk6IDEsXG4gICAgICBtYXhDYXBhY2l0eTogMSxcbiAgICAgIHZwY1N1Ym5ldHM6IHtcbiAgICAgICAgc3VibmV0VHlwZTogZWMyLlN1Ym5ldFR5cGUuUFJJVkFURV9XSVRIX0VHUkVTU1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIEFTRyBhcyB0YXJnZXQgZm9yIEFMQlxuICAgIHN0cmVhbWxpdExpc3RlbmVyLmFkZFRhcmdldHMoJ1N0cmVhbWxpdC1UYXJnZXQnLCB7XG4gICAgICBwb3J0OiA4NTAyLFxuICAgICAgcHJvdG9jb2w6IGVsYnYyLkFwcGxpY2F0aW9uUHJvdG9jb2wuSFRUUCxcbiAgICAgIHRhcmdldHM6IFthc2ddLFxuICAgICAgaGVhbHRoQ2hlY2s6IHtcbiAgICAgICAgcGF0aDogJy8nLFxuICAgICAgICB1bmhlYWx0aHlUaHJlc2hvbGRDb3VudDogMyxcbiAgICAgICAgaGVhbHRoeVRocmVzaG9sZENvdW50OiAyLFxuICAgICAgICBpbnRlcnZhbDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMzApLFxuICAgICAgICB0aW1lb3V0OiBjZGsuRHVyYXRpb24uc2Vjb25kcygxMCksXG4gICAgICAgIGhlYWx0aHlIdHRwQ29kZXM6ICcyMDAsMzAyJ1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU3RhY2sgT3V0cHV0c1xuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsICdTdHJlYW1saXRFbmRwb2ludCcsIHtcbiAgICAgIHZhbHVlOiBgaHR0cDovLyR7YWxiLmxvYWRCYWxhbmNlckRuc05hbWV9Ojg1MDJgLFxuICAgICAgZGVzY3JpcHRpb246ICdTdHJlYW1saXQgVUkgRW5kcG9pbnQnXG4gICAgfSk7XG5cbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnQWxsb3dlZENJRFInLCB7XG4gICAgICB2YWx1ZTogYWxsb3dlZENpZHIsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NJRFIgYmxvY2sgYWxsb3dlZCB0byBhY2Nlc3MgdGhlIGFwcGxpY2F0aW9uJ1xuICAgIH0pO1xuXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0RlcGxveW1lbnRNZXRob2QnLCB7XG4gICAgICB2YWx1ZTogJ0dpdCBDbG9uZSBmcm9tIEdpdEh1YiAod2l0aCBBV1MgQ0xJIHByZS1pbnN0YWxsZWQpJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnSG93IHRoZSBhcHBsaWNhdGlvbiBjb2RlIGlzIGRlcGxveWVkJ1xuICAgIH0pO1xuXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0F1dGhlbnRpY2F0aW9uJywge1xuICAgICAgdmFsdWU6ICdVc2VzIEVDMiBJbnN0YW5jZSBSb2xlIChubyBBUEkga2V5cyBuZWVkZWQpJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQXV0aGVudGljYXRpb24gbWV0aG9kJ1xuICAgIH0pO1xuICB9XG59XG4iXX0=